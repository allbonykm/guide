<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ìœ¨ì´ì˜ ìì•„ì—¬í–‰</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Jua&family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #fff7ed; overflow: hidden; touch-action: manipulation; }
        .font-comic { font-family: 'Jua', sans-serif; }
        @keyframes float { 0% { transform: translateY(0px) rotate(0deg); } 50% { transform: translateY(-5px) rotate(5deg); } 100% { transform: translateY(0px) rotate(0deg); } }
        .btn-theme { animation: float 2.5s infinite ease-in-out; cursor: pointer; transition: all 0.2s; }
        .btn-theme:active { transform: scale(0.9); }
        .text-box { background-color: rgba(255, 255, 255, 0.98); border-radius: 20px 20px 0 0; box-shadow: 0 -4px 15px rgba(0,0,0,0.1); }
        .img-container { width: 100%; height: 100%; background-color: #fef3c7; display: flex; align-items: center; justify-content: center; overflow: hidden; position: relative; }
        .img-cover { width: 100%; height: 100%; object-fit: cover; }
        .img-fit { width: 100%; height: 100%; object-fit: contain; }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        /* ìºë¦­í„° ìƒ‰ìƒ í´ë˜ìŠ¤ */
        .char-yul { color: #0ea5e9; font-weight: 700; } /* sky-500 */
        .char-toto { color: #ec4899; font-weight: 700; } /* pink-500 */
        .char-lily { color: #16a34a; font-weight: 700; } /* green-600 */
        .char-gyeol { color: #f97316; font-weight: 700; } /* orange-500 */
        .char-mom { color: #a855f7; font-weight: 700; } /* purple-500 */
    </style>
</head>
<body class="h-screen w-screen flex flex-col justify-center items-center">
    <div id="app" class="w-full h-full max-w-md bg-white relative shadow-2xl overflow-hidden flex flex-col border-x border-orange-100"></div>
    <script>
        // *** AI ë°ì´í„° ìƒì„± ì˜ì—­ ***
        // ì´ë¯¸ì§€ í‚¤ì›Œë“œ: ego
        
        // ì´ëª¨ì§€ ë³€ê²½: ìºìŠ¤í„°ë„¤ì¸  ì†Œë¦¬(ë”±ë”±ë”±)ì™€ ìœ ì‚¬í•œ ë°•ìˆ˜(ğŸ‘) ì ìš©
        const THEME_EMOJI = "ğŸ‘"; 

        const storyData = [
            // 0. í‘œì§€
            {
                type: 'cover',
                image: 'images/ego0.jpg', // ê²½ë¡œ ìˆ˜ì •
                title: 'ìœ¨ì´ì˜ ìì•„ì—¬í–‰',
                sub: 'ê²°ì•„! ì™œ ê·¸ëŸ¬ë‹ˆ?'
            },
            // 1. ë“±ì¥ì¸ë¬¼
            {
                type: 'intro',
                image: 'images/ego1.jpg', // ê²½ë¡œ ìˆ˜ì •
                title: 'ë“±ì¥ì¸ë¬¼ ì†Œê°œ',
                content: `
                    <p class="mb-2"><span class="char-yul">ì¡°ìœ¨ (ì²­ê³¡ì´ˆ 1í•™ë…„)</span><br>í¬ë‹ˆí…Œì¼ì´ ì˜ ì–´ìš¸ë¦¬ê³ , ë°°ë ¤ì‹¬ì´ ë§ì€ ë©‹ì§„ ì•„ì´.</p>
                    <p class="mb-2"><span class="char-gyeol">ê¹€ê²° (ì‚¬ì´Œ ë™ìƒ, 4ì‚´)</span><br>ì„¸ìƒ ëª¨ë“  ê²Œ ìê¸° ê²ƒì¸ ê·€ì—¬ìš´ ê³ ì§‘ìŸì´.</p>
                    <p class="mb-2"><span class="char-toto">í† í†  (ê°€ì´ë“œ)</span><br>ìœ¨ì´ì˜ ë§ˆìŒì„ ì½ì–´ì£¼ê³  ì• ì°© í† ë¼ ì¸í˜•.</p>
                    <p><span class="char-lily">ë°±í•© (ë¦´ë¦¬ í™”ì´íŠ¸)</span><br>ê¼¬ë¦¬ê°€ ë¹›ë‚˜ë©´ ì‹œê°„ ì—¬í–‰ì„ í•˜ëŠ” ë¦´ë¦¬ í™”ì´íŠ¸.</p>
                `
            },
            // 2. ì œ1ì¥ (ì¥ë©´ 1,2,3 í†µí•©)
            {
                type: 'story', image: 'images/ego2.jpg', // ê²½ë¡œ ìˆ˜ì •
                title: 'ì œ1ì¥: ê²€ì€ ê¸°ë‘¥ì„ ì§€ì¼œë¼!',
                content: `
                    <p>ìœ¨ì´ëŠ” ê²€ì€ìƒ‰ í¼ë¡¤ëŸ¬ ìœ„ì— ì„œì„œ ê· í˜•ì„ ì¡ê³  ìˆì—ˆì–´ìš”. ë–¨ì–´ì§€ì§€ ì•Šìœ¼ë ¤ê³  ë°œê°€ë½ì— í˜ì„ ê½‰ ì£¼ì—ˆì§€ìš”.</p>
                    <p class="mt-2"><span class="char-yul">ì¡°ìœ¨</span>: "ë‚˜ ì˜ ì„œ ìˆì§€? ê· í˜• ì¡ëŠ” ê±° ì¬ë°Œì–´."</p>
                    <p class="mt-2"><span class="char-toto">í† í† </span>: "ì˜¤, ìœ¨ì´ ìì„¸ê°€ ì¢‹ì€ë°?"</p>
                    <hr class="my-4 border-dashed border-gray-300">
                    <p>ê·¸ë•Œ ë°©ë¬¸ì´ ì—´ë¦¬ê³  ë™ìƒ ê²°ì´ê°€ ë“¤ì–´ì™”ì–´ìš”. ê²°ì´ì˜ ëˆˆì´ í¼ë¡¤ëŸ¬ë¥¼ ë³´ìë§ˆì ë°˜ì§ê±°ë ¸ì–´ìš”.</p>
                    <p class="mt-2"><span class="char-gyeol">ê¹€ê²°</span>: "ìš°ì™€! ê²°ì´ê±°ë‹¤! ì¹™ì¹™í­í­ í• ë˜!"</p>
                    <p class="mt-2"><span class="char-yul">ì¡°ìœ¨</span>: "ì–´? ê²°ì•„, ì•ˆë…•? ê·¼ë° ì´ê±´ ê¸°ì°¨ê°€ ì•„ë‹ˆì•¼."</p>
                    <p class="mt-4">ê²°ì´ê°€ ë‹¬ë ¤ë“¤ì ìœ¨ì´ëŠ” í¼ë¡¤ëŸ¬ë¥¼ ë’¤ë¡œ íœ™ ìˆ¨ê²¼ì–´ìš”.</p>
                    <p class="mt-2"><span class="char-gyeol">ê¹€ê²°</span>: "ê²°ì´ë„ í• ë˜! êµ´ëŸ¬ê°€ëŠ” ê±° ì¤˜!"</p>
                    <p class="mt-2"><span class="char-yul">ì¡°ìœ¨</span>: "ì•ˆ ë¼! ì´ê±´ ìœ¨ì´ ìš´ë™í•˜ëŠ” ê±°ì•¼. ì¥ë‚œê°ì´ ì•„ë‹ˆë¼ê³ !"</p>
                `
            },
            // 3. ì œ2ì¥ (ì¥ë©´ 1,2,3 í†µí•©)
            {
                type: 'story', image: 'images/ego3.jpg', // ê²½ë¡œ ìˆ˜ì •
                title: 'ì œ2ì¥: ëˆˆë¬¼ ë°”ë‹¤ê°€ ëœ ê±°ì‹¤',
                content: `
                    <p>ê²°ì´ëŠ” ìœ¨ì´ì˜ ë°”ì§€ ìë½ì„ ì¡ê³  ëŠ˜ì–´ì¡Œì–´ìš”. íŒŒìë§ˆê°€ ì­‰ ëŠ˜ì–´ë‚¬ì§€ìš”.</p>
                    <p class="mt-2"><span class="char-gyeol">ê¹€ê²°</span>: "ë‚´ ê±°ì•¼! ë‚´ê°€ ë¨¼ì € ë´¤ì–´!"</p>
                    <p class="mt-2"><span class="char-yul">ì¡°ìœ¨</span>: "ì•„ë‹ˆë¼ë‹ˆê¹Œ! ì´ê±´ ì•„ë¹ ê°€ ì‚¬ì¤€ ë‚´ ê±°ì•¼!"</p>
                    <hr class="my-4 border-dashed border-gray-300">
                    <p class="mt-2"><span class="char-gyeol">ê¹€ê²°</span>: "......ìœ¼....ìœ¼ì•„..."</p>
                    <p class="mt-4">ê²°ì´ê°€ ë°”ë‹¥ì— ëˆ„ì›Œ ëŒ€ì„±í†µê³¡ì„ ì‹œì‘í–ˆì–´ìš”.</p>
                    <p class="mt-2"><span class="char-gyeol">ê¹€ê²°</span>: "ìœ¼ì•„ì•™!! ì—„ë§ˆ!! ì—„ë§ˆ ë³´ê³  ì‹¶ì–´!!"</p>
                    <p class="mt-2"><span class="char-yul">ì¡°ìœ¨</span>: "ì•„, ì‹œë„ëŸ¬ì›Œ! ì™œ ìê¾¸ ë–¼ë¥¼ ì“°ëŠ” ê±°ì•¼?"</p>
                `
            },
            // 4. ì œ3ì¥ (ì¥ë©´ 1,2,3 í†µí•©)
            {
                type: 'story', image: 'images/ego4.jpg', // ê²½ë¡œ ìˆ˜ì •
                title: 'ì œ3ì¥: ë°±í•©ì˜ ê¼¬ë¦¬ê°€ ë¹›ë‚  ë•Œ',
                content: `
                    <p>ê·¸ ìˆœê°„, ì‹œê°„ì´ ë©ˆì¶˜ ë“¯ ë°© ì•ˆì´ ì¡°ìš©í•´ì¡Œì–´ìš”. ìœ¨ì´ ì–´ê¹¨ ìœ„ì˜ ë°±í•© ê¼¬ë¦¬ê°€ í˜•ê´‘ë“±ì²˜ëŸ¼ í™˜í•˜ê²Œ ë¹›ë‚˜ê¸° ì‹œì‘í–ˆì£ !</p>
                    <p class="mt-2"><span class="char-yul">ì¡°ìœ¨</span>: "ì–´? ë°±í•©ì•„! ê¼¬ë¦¬ì— ë¶ˆ ë“¤ì–´ì™”ì–´!"</p>
                    <p class="mt-2"><span class="char-toto">í† í† </span>: "ì, ìœ¨ì•„! ì—¬í–‰ì„ ë– ë‚˜ë³¼ê¹Œ? ê¹€ê²°ì˜ ë¨¸ë¦¿ì†ìœ¼ë¡œ!"</p>
                    <hr class="my-4 border-dashed border-gray-300">
                    <p>í† í† ê°€ ëª½ê¸€ëª½ê¸€í•œ êµ¬ë¦„ ì†ì—ì„œ ì¹ íŒì„ ê°€ë¦¬ì¼°ì–´ìš”. ì¹ íŒì—ëŠ” ì™•ê´€ì„ ì“´ ê²°ì´ê°€ ê·¸ë ¤ì ¸ ìˆì—ˆì£ .</p>
                    <p class="mt-2"><span class="char-toto">í† í† </span>: "ìœ¨ì•„, 4ì‚´ ê²°ì´ì˜ ì„¸ìƒì—ì„œëŠ” ìê¸°ê°€ ì™•ì´ì•¼. 'ë‚´ê°€ ë³´ê³  ì‹¶ì€ ê±´ ë‚´ ê²ƒ', 'ë‚´ê°€ ê°–ê³  ì‹¶ì€ ê²ƒë„ ë‚´ ê²ƒ'ì´ë¼ê³  ìƒê°í•´. ë‚˜ìœ ê²Œ ì•„ë‹ˆë¼ ì•„ì§ ë°°ìš°ëŠ” ì¤‘ì¸ ê±°ì•¼."</p>
                    <p class="mt-4">ë‹¤ì‹œ ë°©ìœ¼ë¡œ ëŒì•„ì˜¤ì, ë°±í•©ì´ í¼ë¡¤ëŸ¬ ìœ„ì—ì„œ ê¼¬ë¦¬ë¥¼ ì‚´ë‘ê±°ë ¸ì–´ìš”.</p>
                    <p class="mt-2"><span class="char-toto">í† í† </span>: "ê·¸ëŸ´ ë• ëºëŠ” ê²Œ ì•„ë‹ˆë¼ 'êµí™˜'ì„ í•˜ëŠ” ê±°ì•¼. ê²°ì´ëŠ” ì§€ê¸ˆ ì´ ê¹Œë§Œ ê¸°ë‘¥ì— ê½‚í˜€ì„œ ë‹¤ë¥¸ ê±´ ì•ˆ ë³´ì´ê±°ë“ ? ë” ì¬ë°ŒëŠ” ê±¸ ë³´ì—¬ì¤˜ì„œ ì‹œì„ ì„ ëŒë ¤ë´!"</p>
                    <p class="mt-2"><span class="char-yul">ì¡°ìœ¨</span>: "ì‹œì„ ì„ ëŒë¦¬ë¼ê³ ? ì•„í•˜!"</p>
                `
            },
            // 5. ì œ4ì¥ (ì¥ë©´ 1,2,3 í†µí•©)
            {
                type: 'story', image: 'images/ego5.jpg', // ê²½ë¡œ ìˆ˜ì •
                title: 'ì œ4ì¥: ë‚˜ì´ìŠ¤í•œ ìœ¨ì´ ì–¸ë‹ˆ',
                content: `
                    <p>ë°±í•©ì˜ ê¼¬ë¦¬ ë¹›ì´ êº¼ì§€ê³  í˜„ì‹¤ë¡œ ëŒì•„ì™”ì–´ìš”. ìœ¨ì´ëŠ” ì–¼ë¥¸ ì„œëì—ì„œ 'ìºìŠ¤í„°ë„¤ì¸ 'ë¥¼ êº¼ëƒˆì–´ìš”.</p>
                    <p class="mt-2"><span class="char-yul">ì¡°ìœ¨</span>: (ê³¼ì¥ë˜ê²Œ) "ìš°ì™€~! <b>ë”±ë”±ë”±!</b> ì´ê²Œ ë¬´ìŠ¨ ì†Œë¦¬ì§€? ì—°ì£¼ ë†€ì´ í•  ì‚¬ëŒ?"</p>
                    <hr class="my-4 border-dashed border-gray-300">
                    <p>ìš¸ë˜ ê²°ì´ê°€ ëš ê·¸ì¹˜ê³  ê³ ê°œë¥¼ ë“¤ì—ˆì–´ìš”. ì¹™ì¹™í•œ í¼ë¡¤ëŸ¬ë³´ë‹¤ í™”ë ¤í•œ ì†Œë¦¬ê°€ ë‚˜ëŠ” ìºìŠ¤í„°ë„¤ì¸ ì— ëˆˆì´ íœ˜ë‘¥ê·¸ë ˆì¡Œì£ .</p>
                    <p class="mt-2"><span class="char-gyeol">ê¹€ê²°</span>: "......ì—°ì£¼ ë†€ì´?"</p>
                    <p class="mt-2"><span class="char-yul">ì¡°ìœ¨</span>: "ì‘! ê²°ì´ê°€ ì—°ì£¼ í•´. ì–¸ë‹ˆê°€ ê´€ê° í• ê²Œ. ì, ìºìŠ¤í„°ë„¤ì¸ !"</p>
                    <p class="mt-4">ê²°ì´ëŠ” ì–¸ì œ ìš¸ì—ˆëƒëŠ” ë“¯ ë²Œë–¡ ì¼ì–´ë‚˜ ì—°ì£¼ë¥¼ ì‹œì‘í–ˆì–´ìš”.</p>
                    <p class="mt-2"><span class="char-gyeol">ê¹€ê²°</span>: "head and shoulders and knees and toesâ™ª"</p>
                    <p class="mt-2"><span class="char-yul">ì¡°ìœ¨</span>: 'íœ´, ì„±ê³µì´ë‹¤! í¼ë¡¤ëŸ¬ëŠ” ì§€ì¼°ì–´.'</p>
                `
            },
            // 6. ì œ5ì¥ (ì¥ë©´ 1,2,3 í†µí•©)
            {
                type: 'story', image: 'images/ego6.jpg', // ê²½ë¡œ ìˆ˜ì •
                title: 'ì œ5ì¥: ìš°ë¦¬ëŠ” í‰í™” í˜‘ì •',
                content: `
                    <p>ì—„ë§ˆì™€ ê³ ëª¨ê°€ ê³¼ì¼ì„ ê¹ì•„ ë“¤ì–´ì˜¤ë‹¤ê°€ ì‚¬ì´ì¢‹ê²Œ ë…¸ëŠ” ë‘˜ì„ ë³´ê³  ë¯¸ì†Œ ì§€ì—ˆì–´ìš”.</p>
                    <p class="mt-2"><span class="char-mom">ê³ ëª¨</span>: "ì–´ë¨¸, ìš°ë¦¬ ê²°ì´ ëš ê·¸ì³¤ë„¤? ìœ¨ì´ê°€ ì˜ ë†€ì•„ì¤¬êµ¬ë‚˜."</p>
                    <hr class="my-4 border-dashed border-gray-300">
                    <p class="mt-2"><span class="char-yul">ì¡°ìœ¨</span>: "ë„¤, ê²°ì´ê°€ ë…¸ë˜ë¥¼ ì°¸ ì˜í•´ìš”. ê·¸ì¹˜, í† í† ?"</p>
                    <p class="mt-4">ë°±í•©ì˜ ê¼¬ë¦¬ê°€ ì•„ì£¼ ì‚´ì§ ë°˜ì§ì˜€ë‹µë‹ˆë‹¤.</p>
                    <p class="mt-2"><span class="char-yul">ì¡°ìœ¨</span>: 'ë™ìƒì„ ë‹¤ë£¨ëŠ” ë²•, ì´ì œ ë§ˆìŠ¤í„°í–ˆì–´! ë‹¤ìŒì—” ë˜ ë¬´ìŠ¨ ì¼ì´ ìƒê¸¸ê¹Œ?'</p>
                `
            },
            // 7. í€´ì¦ˆ ì¸íŠ¸ë¡œ
            {
                type: 'quiz_intro',
                image: 'images/ego7.jpg', // ê²½ë¡œ ìˆ˜ì •
                title: 'ìœ¨ì´ì˜ OX í€´ì¦ˆ!',
                content: `
                    <p class="text-center text-xl font-bold mt-4">ì, ì—¬í–‰ì—ì„œ ë°°ìš´ ë‚´ìš©ì„<br>í€´ì¦ˆë¡œ í’€ì–´ë³¼ê¹Œ?</p>
                `
            },
            // 8. ì—”ë”©
            {
                type: 'ending',
                image: 'images/ego8.jpg', // ê²½ë¡œ ìˆ˜ì •
            }
        ];

        const quizData = [
            {
                question: "ë™ìƒì´ ë‚´ í¼ë¡¤ëŸ¬ë¥¼ ë‹¬ë¼ê³  ë–¼ì“°ëŠ” ê±´ ìš•ì‹¬ìŸì´ë¼ì„œ ê·¸ëŸ° ê±¸ê¹Œ?",
                answer: false,
                explanation: "4ì‚´ ë™ìƒë“¤ì€ ì•„ì§ ì„¸ìƒì˜ ì¤‘ì‹¬ì´ ìê¸°ë¼ê³  ìƒê°í•´ì„œ ê·¸ë ‡ëŒ€. ì¡°ê¸ˆ ë” í¬ë©´ ë‹¤ë¥¸ ì‚¬ëŒ ë§ˆìŒë„ ì´í•´í•˜ê²Œ ë  ê±°ì•¼."
            },
            {
                question: "ë™ìƒì´ ìš¸ ë•Œ ê°™ì´ í™”ë¥¼ ë‚´ê±°ë‚˜ ë¬¼ê±´ì„ ëºìœ¼ë©´ í•´ê²°ë ê¹Œ?",
                answer: false,
                explanation: "ê°™ì´ í™”ë‚´ë©´ ë™ìƒì€ ë” í¬ê²Œ ìš¸ì–´. í† í† ê°€ ì•Œë ¤ì¤€ ëŒ€ë¡œ ì¹¨ì°©í•˜ê²Œ ë‹¤ë¥¸ ë°©ë²•ì„ ì°¾ëŠ” ê²Œ ë©‹ì§„ ì–¸ë‹ˆì•¼!"
            },
            {
                question: "ë™ìƒì´ ê°–ê³  ì‹¶ì–´ í•˜ëŠ” ë¬¼ê±´ ëŒ€ì‹ , ë” ì¬ë¯¸ìˆëŠ” ì¥ë‚œê°ì„ ë³´ì—¬ì£¼ëŠ” ê±´ ì¢‹ì€ ë°©ë²•ì¼ê¹Œ?",
                answer: true,
                explanation: "ì´ê±¸ 'ì£¼ì˜ í™˜ê¸°'ë¼ê³  í•´. í¼ë¡¤ëŸ¬ ëŒ€ì‹  ìºìŠ¤í„°ë„¤ì¸ ë¥¼ ë³´ì—¬ì£¼ë‹ˆê¹Œ ê¸ˆë°© ìŠì–´ë²„ë ¸ì§€? ì‹¸ìš°ì§€ ì•Šê³  í‰í™”ë¥¼ ì§€í‚¤ëŠ” ê¿€íŒì´ì•¼."
            }
        ];

        // --- ê³ ì • ë¡œì§ (ìˆ˜ì • ë¶ˆí•„ìš”) ---
        let currentState = { pageIndex: 0, quizIndex: 0, quizStatus: 'question', lastAnswer: null };
        const app = document.getElementById('app');

        function render() {
            app.innerHTML = ''; 
            if (currentState.pageIndex < storyData.length) {
                const page = storyData[currentState.pageIndex];
                if (page.type === 'cover') renderCover(page);
                else if (page.type === 'ending') renderEnding(page);
                else renderStoryPage(page, page.type === 'quiz_intro');
            } else if (currentState.pageIndex === storyData.length) renderQuiz();f
        }

        function renderCover(data) {
            const div = document.createElement('div');
            div.className = "w-full h-full relative cursor-pointer fade-in";
            div.onclick = nextPage;
            div.innerHTML = `
                <div class="img-container"><img src="${data.image}" class="img-cover" alt="í‘œì§€" onerror="this.parentElement.innerHTML='<div class=\\'flex flex-col items-center justify-center h-full text-gray-500\\'>ì´ë¯¸ì§€ ì¤€ë¹„ì¤‘<br>${data.image}</div>'"></div>
                <div class="absolute bottom-10 w-full text-center text-white font-comic animate-pulse text-xl drop-shadow-md bg-black/20 py-2">í™”ë©´ì„ íƒ­í•˜ì—¬ ì‹œì‘í•˜ê¸°</div>
            `;
            app.appendChild(div);
        }

        function renderStoryPage(data, isQuizIntro) {
            const div = document.createElement('div');
            div.className = "w-full h-full flex flex-col bg-white fade-in";
            const imgHtml = `<div class="flex-1 img-container relative border-b-4 border-orange-200"><img src="${data.image}" class="img-fit" alt="ì‚½í™”" onerror="this.parentElement.innerHTML='<div class=\\'flex flex-col items-center justify-center h-full text-gray-400\\'>ì´ë¯¸ì§€ ì¤€ë¹„ì¤‘<br>${data.image}</div>'"></div>`;
            
            // í…ìŠ¤íŠ¸ ë¹„ìœ¨ 33% ê³ ì •
            const textHtml = `
                <div class="h-[33%] flex flex-col relative">
                    <div class="flex-1 p-6 overflow-y-auto text-box -mt-6 z-10 text-lg leading-relaxed text-gray-800">
                        ${data.title ? `<h2 class="font-comic text-2xl text-orange-500 mb-1">${data.title}</h2>` : ''}
                        ${data.sub ? `<p class="text-sm text-gray-500 mb-4">${data.sub}</p>` : ''}
                        <div class="space-y-2">${data.content}</div>
                    </div>
                    <div class="h-20 bg-white flex justify-between items-center px-8 border-t border-orange-100 z-20">
                        <div onclick="prevPage()" class="flex flex-col items-center cursor-pointer text-gray-400 hover:text-gray-600 transition"><span class="text-2xl opacity-60">âª</span><span class="text-xs font-bold mt-1">ì´ì „</span></div>
                        ${isQuizIntro ? 
                            `<div onclick="startQuiz()" class="cursor-pointer text-pink-500 flex flex-col items-center"><div class="w-14 h-14 bg-pink-500 rounded-full flex items-center justify-center text-white text-3xl font-bold shadow-lg border-4 border-pink-200">?</div><span class="text-xs font-bold mt-1">í€´ì¦ˆ í’€ê¸°!</span></div>` : 
                            `<div onclick="nextPage()" class="btn-theme flex flex-col items-center text-yellow-500"><span class="text-4xl filter drop-shadow-md">${THEME_EMOJI}</span><span class="text-xs font-bold mt-1 text-yellow-600">ë‹¤ìŒ</span></div>`
                        }
                    </div>
                </div>
            `;
            div.innerHTML = imgHtml + textHtml;
            app.appendChild(div);
        }

        function renderQuiz() {
            if (currentState.quizIndex >= quizData.length) { currentState.pageIndex = storyData.length - 1; currentState.quizIndex = 0; render(); return; }
            const currentQ = quizData[currentState.quizIndex];
            const div = document.createElement('div');
            div.className = "w-full h-full flex flex-col bg-yellow-50 fade-in";
            
            if (currentState.quizStatus === 'question') {
                div.innerHTML = `<div class="flex-1 flex flex-col items-center justify-center p-6 text-center"><span class="text-pink-500 font-bold text-xl mb-4 bg-pink-100 px-4 py-1 rounded-full">ë¬¸ì œ ${currentState.quizIndex + 1} / 3</span><div class="bg-white p-8 rounded-2xl shadow-xl w-full mb-8 border-2 border-yellow-300"><p class="text-2xl font-bold break-keep text-gray-800">${currentQ.question}</p></div><div class="flex gap-6 justify-center"><button onclick="checkAnswer(true)" class="w-24 h-24 bg-blue-500 rounded-full text-white text-5xl font-black shadow-lg">O</button><button onclick="checkAnswer(false)" class="w-24 h-24 bg-red-500 rounded-full text-white text-5xl font-black shadow-lg">X</button></div></div>`;
            } else if (currentState.quizStatus === 'result') {
                const isCorrect = currentState.lastAnswer === currentQ.answer;
                const emoji = isCorrect ? `ğŸ‰${THEME_EMOJI}ğŸ‰` : 'ğŸ¤”ğŸ’¦';
                div.innerHTML = `<div class="w-full h-full ${isCorrect ? 'bg-green-500' : 'bg-orange-400'} flex flex-col items-center justify-center text-white cursor-pointer" onclick="showExplanation()"><div class="text-8xl mb-6 animate-bounce">${emoji}</div><h2 class="text-4xl font-comic mb-4">${isCorrect ? 'ì •ë‹µ!' : 'ë•¡!'}</h2><p class="animate-pulse">íƒ­í•˜ì—¬ í•´ì„¤ ë³´ê¸°</p></div>`;
            } else if (currentState.quizStatus === 'explanation') {
                const isLast = currentState.quizIndex === quizData.length - 1;
                div.innerHTML = `<div class="flex-1 flex flex-col p-6 bg-white cursor-pointer" onclick="nextQuizStep()"><div class="flex-1 flex flex-col justify-center items-center"><h3 class="text-2xl font-comic text-sky-600 mb-6">ğŸ‘§ğŸ» ìœ¨ì´ì˜ ì„¤ëª…</h3><div class="bg-sky-50 p-6 rounded-xl border-2 border-sky-200 shadow-md relative"><div class="absolute -top-4 -left-2 text-4xl">ğŸ’¡</div><p class="text-xl font-medium text-gray-800 leading-relaxed word-keep">"${currentQ.explanation}"</p></div></div><div class="h-24 flex items-center justify-center"><div class="btn-theme flex flex-col items-center"><span class="text-4xl">${THEME_EMOJI}</span><span class="text-sm font-bold text-yellow-600 mt-1">${isLast ? "ì™„ë£Œ!" : "ë‹¤ìŒ ë¬¸ì œ"}</span></div></div></div>`;
            }
            app.appendChild(div);
        }

        function renderEnding(data) {
            const div = document.createElement('div');
            div.className = "w-full h-full relative cursor-pointer fade-in";
            div.onclick = restart;
            div.innerHTML = `
                <div class="img-container"><img src="${data.image}" class="img-cover" alt="ì—”ë”©" onerror="this.parentElement.innerHTML='<div class=\\'flex flex-col items-center justify-center h-full text-gray-500\\'>ì´ë¯¸ì§€ ì¤€ë¹„ì¤‘<br>${data.image}</div>'"></div>
                
                <div class="absolute bottom-16 w-full flex justify-center pb-4">
                     <div class="px-8 py-3 bg-white text-orange-500 rounded-full font-bold text-xl shadow-2xl animate-bounce border-4 border-orange-100">
                        â†º ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°
                    </div>
                </div>
            `;
            app.appendChild(div);
        }

        function nextPage() { if (currentState.pageIndex < storyData.length) { currentState.pageIndex++; render(); }}
        function prevPage() { if (currentState.pageIndex > 0) { currentState.pageIndex--; render(); }}
        function startQuiz() { currentState.pageIndex = storyData.length; currentState.quizIndex = 0; currentState.quizStatus = 'question'; render(); }
        function checkAnswer(ans) { currentState.lastAnswer = ans; currentState.quizStatus = 'result'; render(); }
        function showExplanation() { currentState.quizStatus = 'explanation'; render(); }
        function nextQuizStep() { currentState.quizIndex++; currentState.quizStatus = 'question'; render(); }
        function restart() { currentState.pageIndex = 0; currentState.quizIndex = 0; render(); }

        render();
    </script>
</body>
</html>
