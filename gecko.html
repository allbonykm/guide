<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gecko Cash</title>
    <!-- êµ¬ê¸€ í°íŠ¸ -->
    <link href="https://fonts.googleapis.com/css2?family=Gamja+Flower&family=Fredoka:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-blue: #9ED6E8; /* ì‹œë‚˜ëª¨ë¡¤ í•˜ëŠ˜ìƒ‰ */
            --btn-blue: #7ABCCE;
            --text-color: #333;
            --gold-color: #FFD700; /* í™©ê¸ˆìƒ‰ */
        }

        body {
            font-family: 'Fredoka', 'Gamja Flower', cursive; /* ì˜ë¬¸ì€ ë™ê¸€ë™ê¸€ Fredoka */
            margin: 0;
            padding: 0;
            height: 100vh;
            background-color: var(--bg-blue);
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            color: var(--text-color);
        }

        .screen {
            display: none;
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0; left: 0;
            flex-direction: column;
            justify-content: flex-start; /* ìœ„ì—ì„œë¶€í„° ë°°ì¹˜ */
            align-items: center;
            text-align: center;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .screen.active {
            display: flex;
            animation: fadeIn 0.5s ease;
        }

        /* í…ìŠ¤íŠ¸ ê°€ë…ì„±ì„ ìœ„í•œ ë°˜íˆ¬ëª… ë°•ìŠ¤ */
        .text-box {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 20px;
            margin-top: 10%; /* í™”ë©´ ìƒë‹¨ì—ì„œ ì•½ê°„ ë„ì›€ */
            width: 80%;
            max-width: 350px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            border: 4px solid white;
        }

        h1 { font-size: 32px; color: var(--btn-blue); margin: 0 0 10px 0; }
        h2 { font-size: 24px; margin: 10px 0; color: #555; }
        
        /* í™©ê¸ˆìƒ‰ ê¸ˆì•¡ í‘œì‹œ */
        .gold-text {
            color: #FFB300; /* ì§„í•œ í™©ê¸ˆìƒ‰ */
            font-size: 40px;
            font-weight: bold;
            text-shadow: 2px 2px 0px #fff, 0 0 10px rgba(255, 215, 0, 0.5);
            margin: 15px 0;
            font-family: 'Fredoka', sans-serif;
        }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn-group {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            width: 100%;
            justify-content: center;
        }

        .action-btn {
            width: 100px;
            height: 100px;
            border-radius: 20px;
            border: none;
            font-size: 40px;
            font-weight: bold;
            color: white;
            cursor: pointer;
            box-shadow: 0 5px 0 rgba(0,0,0,0.1);
            transition: transform 0.1s;
        }

        .btn-plus { background-color: #FF9AA2; } /* íŒŒìŠ¤í…” ë ˆë“œ */
        .btn-minus { background-color: #85E3FF; } /* íŒŒìŠ¤í…” ë¸”ë£¨ */
        
        .action-btn:active { transform: translateY(4px); box-shadow: none; }

        input[type="number"] {
            font-size: 30px;
            padding: 15px;
            width: 80%;
            border: 3px solid var(--btn-blue);
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
            outline: none;
            color: var(--text-color);
            font-family: 'Fredoka', sans-serif;
        }

        .confirm-btn {
            background-color: var(--btn-blue);
            color: white;
            font-size: 22px;
            padding: 15px 40px;
            border-radius: 50px;
            border: none;
            cursor: pointer;
            box-shadow: 0 5px 0 #5A9CB5;
        }
        .confirm-btn:active { transform: translateY(4px); box-shadow: none; }

        /* í™”ë©´ë³„ ë°°ê²½ ì´ë¯¸ì§€ ì„¤ì • (ìƒëŒ€ ê²½ë¡œ) */
        #screen-intro { background-image: url('images/cash.jpg'); justify-content: flex-start; }
        #screen-main { background-image: url('images/gecko_smile.jpg'); }
        #screen-earn { background-image: url('images/gecko_bike.jpg'); }
        #screen-spend { background-image: url('images/gecko_shop.jpg'); }
        #screen-result-earn { background-image: url('images/gecko_rich.jpg'); }
        #screen-result-spend { background-image: url('images/gecko_tongue.jpg'); }
        #screen-balance { background-image: url('images/gecko_bank.jpg'); }

        /* ì¸íŠ¸ë¡œ íƒ€ì´í‹€ íŠ¹ë³„ ìŠ¤íƒ€ì¼ */
        #intro-title {
            margin-top: 15%;
            font-size: 48px;
            color: white;
            text-shadow: 3px 3px 0 #000, 0 0 20px rgba(0,0,0,0.5);
            font-family: 'Fredoka', sans-serif;
        }

        /* ë¡œë”© í‘œì‹œ */
        #loading {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.8);
            display: none; justify-content: center; align-items: center; z-index: 999;
            font-size: 24px; color: var(--btn-blue); font-weight: bold;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <!-- ë¡œë”© í™”ë©´ -->
    <div id="loading">Connecting to Gecko Bank...ğŸ¦</div>

    <!-- 1. ì¸íŠ¸ë¡œ í™”ë©´ -->
    <div id="screen-intro" class="screen active" onclick="goToMain()">
        <div id="intro-title">Gecko Cash</div>
        <p style="color: white; margin-top: 300px; font-size: 20px; text-shadow: 1px 1px 2px black;">Tap to start!</p>
    </div>

    <!-- 2. ë©”ì¸ í™”ë©´ (ë‚ ì§œ, ì”ì•¡, ì„ íƒ) -->
    <div id="screen-main" class="screen">
        <div class="text-box">
            <h2 id="today-date"></h2>
            <p>Did you get a lot of<br>Gecko Cash today?</p>
            <div id="current-balance" class="gold-text">Loading...</div>
            <div class="btn-group">
                <button class="action-btn btn-plus" onclick="goToEarn()">+</button>
                <button class="action-btn btn-minus" onclick="goToSpend()">-</button>
            </div>
        </div>
    </div>

    <!-- 3-1. ì ë¦½ ì…ë ¥ í™”ë©´ -->
    <div id="screen-earn" class="screen">
        <div class="text-box">
            <h2>Enter the cash<br>you earned today!</h2>
            <input type="number" id="earn-input" placeholder="0" inputmode="numeric">
            <button class="confirm-btn" onclick="submitCash('earn')">OK! Save it!</button>
            <button onclick="goToMain()" style="background:none; border:none; color:#999; margin-top:10px; text-decoration:underline;">Back</button>
        </div>
    </div>

    <!-- 3-2. ì‚¬ìš© ì…ë ¥ í™”ë©´ -->
    <div id="screen-spend" class="screen">
        <div class="text-box">
            <h2>Enter the cash<br>you spent today.</h2>
            <input type="number" id="spend-input" placeholder="0" inputmode="numeric">
            <button class="confirm-btn" onclick="submitCash('spend')">OK! I spent it.</button>
            <button onclick="goToMain()" style="background:none; border:none; color:#999; margin-top:10px; text-decoration:underline;">Back</button>
        </div>
    </div>

    <!-- 4-1. ì ë¦½ ì„±ê³µ í™”ë©´ -->
    <div id="screen-result-earn" class="screen" onclick="goToBalance()">
        <div class="text-box">
            <h2>Great job!</h2>
            <p>I'm rich with<br>Gecko Cash!</p>
            <p style="font-size:14px; color:#aaa;">(Tap to see balance)</p>
        </div>
    </div>

    <!-- 4-2. ì‚¬ìš© ì„±ê³µ í™”ë©´ -->
    <div id="screen-result-spend" class="screen" onclick="goToBalance()">
        <div class="text-box">
            <h2>I'm a smart shopper!</h2>
            <p>Cho Yul!</p>
            <p style="font-size:14px; color:#aaa;">(Tap to see balance)</p>
        </div>
    </div>

    <!-- 5. ìµœì¢… ì”ì•¡ í™”ë©´ -->
    <div id="screen-balance" class="screen">
        <div class="text-box">
            <h2>How much<br>Gecko Cash do I have?</h2>
            <div id="final-balance" class="gold-text">0</div>
            <button class="confirm-btn" onclick="goToMain()">Go Home ğŸ </button>
        </div>
    </div>

    <script>
        // ==========================================
        // [í•„ìˆ˜] ë°°í¬í•œ ì•±ìŠ¤ ìŠ¤í¬ë¦½íŠ¸ URLì„ ì—¬ê¸°ì— ë„£ìœ¼ì„¸ìš”
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwKsnNwSizn1kaeGbYtBoPUVzc28H2UlSpD2rvEixBS-aCLpYCDLYh08Y8uN4wG11O4WA/exec';
        // ==========================================

        let myBalance = 0; // í˜„ì¬ ì”ì•¡ ì €ì¥ìš© ë³€ìˆ˜

        // ë‚ ì§œ ì„¤ì •
        const today = new Date();
        const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'short' };
        document.getElementById('today-date').innerText = today.toLocaleDateString('en-US', options);

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        // ì¸íŠ¸ë¡œ -> ë©”ì¸ (ì´ë•Œ ì”ì•¡ì„ ì„œë²„ì—ì„œ ë¶ˆëŸ¬ì˜´)
        function goToMain() {
            showLoading(true);
            fetch(SCRIPT_URL) // GET ìš”ì²­
                .then(response => response.json())
                .then(data => {
                    myBalance = parseInt(data.balance);
                    updateBalanceDisplay();
                    showLoading(false);
                    showScreen('screen-main');
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert("ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”!");
                    showLoading(false);
                    showScreen('screen-main'); // ì—ëŸ¬ë‚˜ë„ ì¼ë‹¨ ì´ë™
                });
        }

        function goToEarn() {
            document.getElementById('earn-input').value = '';
            showScreen('screen-earn');
        }

        function goToSpend() {
            document.getElementById('spend-input').value = '';
            showScreen('screen-spend');
        }

        function goToBalance() {
            showScreen('screen-balance');
        }

        // ëˆ í‘œì‹œ í¬ë§· (1,000)
        function formatMoney(num) {
            return num.toLocaleString();
        }

        function updateBalanceDisplay() {
            document.getElementById('current-balance').innerText = formatMoney(myBalance);
            document.getElementById('final-balance').innerText = formatMoney(myBalance);
        }

        // ë°ì´í„° ì „ì†¡ (ì ë¦½/ì‚¬ìš©)
        function submitCash(type) {
            const inputId = type === 'earn' ? 'earn-input' : 'spend-input';
            const val = document.getElementById(inputId).value;
            
            if (!val || val <= 0) {
                alert("Please enter a number!");
                return;
            }

            showLoading(true);

            // í¼ ë°ì´í„° ìƒì„±
            let formData = new FormData();
            formData.append('type', type);
            formData.append('amount', val);

            fetch(SCRIPT_URL, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                // ì„œë²„ì—ì„œ ê³„ì‚°ëœ ìƒˆ ì”ì•¡ì„ ë°›ì•„ì„œ ì—…ë°ì´íŠ¸
                myBalance = parseInt(data.newBalance);
                updateBalanceDisplay();
                showLoading(false);

                if (type === 'earn') {
                    showScreen('screen-result-earn');
                } else {
                    showScreen('screen-result-spend');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert("ì €ì¥ì— ì‹¤íŒ¨í–ˆì–´ìš” ã… ã… ");
                showLoading(false);
            });
        }

        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'flex' : 'none';
        }
    </script>
</body>
</html>
