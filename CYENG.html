<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pete's English Class (Character Select)</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Jua&family=Fredoka:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body { font-family: 'Fredoka', sans-serif; -webkit-tap-highlight-color: transparent; }
        .korean-font { font-family: 'Jua', sans-serif; }
        .animate-fade-in { animation: fadeIn 0.5s ease-out; }
        .animate-pop { animation: pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pop { 0% { transform: scale(0.9); } 100% { transform: scale(1); } }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .text-outline {
    text-shadow: 
        -2px -2px 0 #fff,  
         2px -2px 0 #fff,
        -2px  2px 0 #fff,
         2px  2px 0 #fff;
}
    </style>
</head>
<body class="bg-sky-50 text-slate-800 min-h-screen">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;

        // âš ï¸ [ì¤‘ìš”] êµ¬ê¸€ API í‚¤ ì…ë ¥
        const GOOGLE_API_KEY = "AIzaSyByK5uSOG_fCAsFDtY6vDQLdC1VGc2-wMc"; 

        // --- ë°ì´í„° ---
        const STORY_DATA = [
          { en: "Pete is going to the pet store.", ko: "í”¼íŠ¸ëŠ” ì• ì™„ë™ë¬¼ ê°€ê²Œì— ê°€ê³  ìˆì–´ìš”." },
          { en: "He is going to get a pet.", ko: "ê·¸ëŠ” ì• ì™„ë™ë¬¼ì„ í•œ ë§ˆë¦¬ ì‚¬ë ¤ê³  í•´ìš”." },
          { en: "Pete wants a bird, a hamster, or a lizard.", ko: "í”¼íŠ¸ëŠ” ìƒˆë‚˜ í–„ìŠ¤í„°, í˜¹ì€ ë„ë§ˆë±€ì„ ì›í•´ìš”." },
          { en: "But then Pete sees a goldfish.", ko: "í•˜ì§€ë§Œ ê·¸ë•Œ í”¼íŠ¸ëŠ” ê¸ˆë¶•ì–´ë¥¼ ë´ìš”." },
          { en: "\"That's what I want,\" he tells his mom.", ko: "\"ì €ê²Œ ì œê°€ ì›í•˜ëŠ” ê±°ì˜ˆìš”,\" ê·¸ê°€ ì—„ë§ˆì—ê²Œ ë§í•´ìš”." },
          { en: "Pete's mom gets fish food.", ko: "í”¼íŠ¸ì˜ ì—„ë§ˆëŠ” ë¬¼ê³ ê¸° ë¨¹ì´ë¥¼ ì‚¬ìš”." },
          { en: "\"I'm going to call you Goldie,â€ Pete says to his new pet.", ko: "\"ë„ˆë¥¼ ê³¨ë””ë¼ê³  ë¶€ë¥¼ ê±°ì•¼,\" í”¼íŠ¸ê°€ ìƒˆ ì• ì™„ë™ë¬¼ì—ê²Œ ë§í•´ìš”." },
          { en: "\"You are my first pet,\" Pete tells Goldie on the way home.", ko: "\"ë„Œ ë‚´ ì²« ë²ˆì§¸ ì• ì™„ë™ë¬¼ì´ì•¼,\" í”¼íŠ¸ê°€ ì§‘ì— ê°€ëŠ” ê¸¸ì— ê³¨ë””ì—ê²Œ ë§í•´ìš”." },
          { en: "Pete takes Goldie to his room.", ko: "í”¼íŠ¸ëŠ” ê³¨ë””ë¥¼ ìì‹ ì˜ ë°©ìœ¼ë¡œ ë°ë ¤ê°€ìš”." },
          { en: "He feeds her fish food.", ko: "ê·¸ëŠ” ê³¨ë””ì—ê²Œ ë¨¹ì´ë¥¼ ì¤˜ìš”." },
          { en: "\"Now what?\" asks Pete.", ko: "\"ì´ì œ ë­ í•˜ì§€?\" í”¼íŠ¸ê°€ ë¬¼ì–´ìš”." },
          { en: "He can't play with Goldie.", ko: "ê·¸ëŠ” ê³¨ë””ë‘ ë†€ ìˆ˜ê°€ ì—†ì–´ìš”." },
          { en: "He can't swim with her.", ko: "ê·¸ëŠ” ê³¨ë””ì™€ í•¨ê»˜ ìˆ˜ì˜í•  ìˆ˜ë„ ì—†ì–´ìš”." },
          { en: "Pete knows what he can do.", ko: "í”¼íŠ¸ëŠ” ìì‹ ì´ ë¬´ì—‡ì„ í•  ìˆ˜ ìˆëŠ”ì§€ ì•Œì•„ìš”." },
          { en: "Pete paints a picture of Goldie.", ko: "í”¼íŠ¸ëŠ” ê³¨ë””ì˜ ê·¸ë¦¼ì„ ê·¸ë ¤ìš”." },
          { en: "He paints four fins and an orange tail.", ko: "ê·¸ëŠ” ë„¤ ê°œì˜ ì§€ëŠëŸ¬ë¯¸ì™€ ì£¼í™©ìƒ‰ ê¼¬ë¦¬ë¥¼ ê·¸ë ¤ìš”." },
          { en: "\"What a pretty painting,â€œ says Pete's mom.", ko: "\"ì •ë§ ì˜ˆìœ ê·¸ë¦¼ì´êµ¬ë‚˜,\" í”¼íŠ¸ì˜ ì—„ë§ˆê°€ ë§í•´ìš”." },
          { en: "\"You can keep it,\" says Pete.", ko: "\"ì—„ë§ˆ ê°€ì§€ì„¸ìš”,\" í”¼íŠ¸ê°€ ë§í•´ìš”." },
          { en: "\"Cool painting!\" says Bob.", ko: "\"ë©‹ì§„ ê·¸ë¦¼ì´ë‹¤!\" ë°¥ì´ ë§í•´ìš”." },
          { en: "\"Can you make one for me?\"", ko: "\"ë‚˜í•œí…Œë„ í•˜ë‚˜ ê·¸ë ¤ì¤„ ìˆ˜ ìˆì–´?\"" },
          { en: "\"Sure,\" says Pete.", ko: "\"ê·¸ëŸ¼,\" í”¼íŠ¸ê°€ ë§í•´ìš”." },
          { en: "Pete paints a picture for Bob.", ko: "í”¼íŠ¸ëŠ” ë°¥ì„ ìœ„í•´ ê·¸ë¦¼ì„ ê·¸ë ¤ìš”." },
          { en: "\"Wow!\" says Bob.", ko: "\"ì™€!\" ë°¥ì´ ë§í•´ìš”." },
          { en: "\"It looks just like Goldie.\"", ko: "\"ë”± ê³¨ë””ì²˜ëŸ¼ ìƒê²¼ë„¤.\"" },
          { en: "Bob shows Pete's painting to his friend Tom.", ko: "ë°¥ì€ í”¼íŠ¸ì˜ ê·¸ë¦¼ì„ ì¹œêµ¬ í†°ì—ê²Œ ë³´ì—¬ì¤˜ìš”." },
          { en: "Now Tom wants a painting, too.", ko: "ì´ì œ í†°ë„ ê·¸ë¦¼ì„ ì›í•´ìš”." },
          { en: "Pete paints another picture of Goldie to take to school for show-and-tell.", ko: "í”¼íŠ¸ëŠ” í•™êµ ë°œí‘œ ì‹œê°„ì— ê°€ì ¸ê°€ë ¤ê³  ê³¨ë”” ê·¸ë¦¼ì„ í•˜ë‚˜ ë” ê·¸ë ¤ìš”." },
          { en: "\"This is Goldie, my pet fish,\" Pete tells his class.", ko: "\"ì´ê±´ ë‚´ ì• ì™„ ë¬¼ê³ ê¸° ê³¨ë””ì•¼,\" í”¼íŠ¸ê°€ ë°˜ ì¹œêµ¬ë“¤ì—ê²Œ ë§í•´ìš”." },
          { en: "â€œCute fish!â€", ko: "\"ê·€ì—¬ìš´ ë¬¼ê³ ê¸°ë‹¤!\"" },
          { en: "â€œCool colors!â€", ko: "\"ìƒ‰ê¹” ë©‹ì§€ë‹¤!\"" },
          { en: "â€œNice work!â€", ko: "\"ì˜ ê·¸ë ¸ë‹¤!\"" },
          { en: "\"I wish I had a picture of Goldie,\" says Benny.", ko: "\"ë‚˜ë„ ê³¨ë”” ê·¸ë¦¼ì´ ìˆìœ¼ë©´ ì¢‹ê² ë‹¤,\" ë² ë‹ˆê°€ ë§í•´ìš”." },
          { en: "\"Iâ€™ll make you one,\" says Pete.", ko: "\"ë‚´ê°€ í•˜ë‚˜ ê·¸ë ¤ì¤„ê²Œ,\" í”¼íŠ¸ê°€ ë§í•´ìš”." },
          { en: "Everyone in Pete's class wants a painting of Goldie!", ko: "í”¼íŠ¸ë„¤ ë°˜ ì¹œêµ¬ë“¤ ëª¨ë‘ê°€ ê³¨ë”” ê·¸ë¦¼ì„ ì›í•´ìš”!" },
          { en: "Pete's grandma wants a painting, too.", ko: "í”¼íŠ¸ì˜ í• ë¨¸ë‹ˆë„ ê·¸ë¦¼ì„ ì›í•´ìš”." },
          { en: "Pete has a lot to do.", ko: "í”¼íŠ¸ëŠ” í•  ì¼ì´ ë§ì•„ìš”." },
          { en: "He has to feed Goldie.", ko: "ê·¸ëŠ” ê³¨ë”” ë°¥ë„ ì¤˜ì•¼ í•´ìš”." },
          { en: "He has to do homework.", ko: "ìˆ™ì œë„ í•´ì•¼ í•˜ê³ ìš”." },
          { en: "Pete paints and paints.", ko: "í”¼íŠ¸ëŠ” ê·¸ë¦¼ì„ ê·¸ë¦¬ê³  ë˜ ê·¸ë ¤ìš”." },
          { en: "He makes paintings for everyone on his list.", ko: "ê·¸ëŠ” ëª…ë‹¨ì— ìˆëŠ” ëª¨ë“  ì‚¬ëŒì„ ìœ„í•´ ê·¸ë¦¼ì„ ê·¸ë ¤ìš”." },
          { en: "At last Pete is done!", ko: "ë“œë””ì–´ í”¼íŠ¸ê°€ ë‹¤ ëëƒˆì–´ìš”!" },
          { en: "He worked hard.", ko: "ê·¸ëŠ” ì—´ì‹¬íˆ ì¼í–ˆì–´ìš”." },
          { en: "There is no paint left.", ko: "ë¬¼ê°ì´ í•˜ë‚˜ë„ ì•ˆ ë‚¨ì•˜ì–´ìš”." },
          { en: "Pete's paintings are a big hit!", ko: "í”¼íŠ¸ì˜ ê·¸ë¦¼ë“¤ì€ í° ì¸ê¸°ë¥¼ ëŒì–´ìš”!" },
          { en: "Pete is happy to be done.", ko: "í”¼íŠ¸ëŠ” ë‹¤ ëë‚´ì„œ í–‰ë³µí•´ìš”." },
          { en: "But Pete is not done.", ko: "í•˜ì§€ë§Œ í”¼íŠ¸ëŠ” ëë‚œ ê²Œ ì•„ë‹ˆì—ìš”." },
          { en: "Now everyone in town wants a painting of Goldie!", ko: "ì´ì œ ë™ë„¤ ì‚¬ëŒë“¤ ëª¨ë‘ê°€ ê³¨ë”” ê·¸ë¦¼ì„ ì›í•´ìš”!" },
          { en: "Pete gets more paint.", ko: "í”¼íŠ¸ëŠ” ë¬¼ê°ì„ ë” ì‚¬ìš”." },
          { en: "\"I don't know what to do,\" he says to his mom.", ko: "\"ì–´ë–»ê²Œ í•´ì•¼ í• ì§€ ëª¨ë¥´ê² ì–´ìš”,\" ê·¸ê°€ ì—„ë§ˆì—ê²Œ ë§í•´ìš”." },
          { en: "\"I wish I could paint pictures for everyone.", ko: "\"ëª¨ë‘ì—ê²Œ ê·¸ë¦¼ì„ ê·¸ë ¤ì¤„ ìˆ˜ ìˆìœ¼ë©´ ì¢‹ê² ì–´ìš”." },
          { en: "I just don't have time.\"", ko: "ê·¸ëƒ¥ ì‹œê°„ì´ ì—†ì–´ìš”.\"" },
          { en: "Pete's mom has an idea!", ko: "í”¼íŠ¸ì˜ ì—„ë§ˆì—ê²Œ ì¢‹ì€ ìƒê°ì´ ë‚¬ì–´ìš”!" },
          { en: "She tells it to Pete.", ko: "ê·¸ë…€ëŠ” í”¼íŠ¸ì—ê²Œ ê·¸ê±¸ ë§í•´ì¤˜ìš”." },
          { en: "\"Great idea!\" says Pete.", ko: "\"ë©‹ì§„ ìƒê°ì´ì—ìš”!\" í”¼íŠ¸ê°€ ë§í•´ìš”." },
          { en: "Pete gets right to it.", ko: "í”¼íŠ¸ëŠ” ë°”ë¡œ ì‹œì‘í•´ìš”." },
          { en: "This time he works outside and makes a huge painting.", ko: "ì´ë²ˆì— ê·¸ëŠ” ë°–ì—ì„œ ì‘ì—…í•˜ë©° ì•„ì£¼ í° ê·¸ë¦¼ì„ ê·¸ë ¤ìš”." },
          { en: "Honk! Honk!", ko: "ë¹µ! ë¹µ!" },
          { en: "Beep! Beep!", ko: "ë ë ! ë ë !" },
          { en: "Here comes Pete!", ko: "í”¼íŠ¸ê°€ ë‚˜ê°€ìš”!" },
          { en: "He has made one painting of Goldie for everyone in town to enjoy!", ko: "ê·¸ëŠ” ë§ˆì„ ì‚¬ëŒ ëª¨ë‘ê°€ ì¦ê¸¸ ìˆ˜ ìˆë„ë¡ ê³¨ë”” ê·¸ë¦¼ì„ í•˜ë‚˜ ê·¸ë ¸ì–´ìš”!" },
          { en: "What a great day!", ko: "ì •ë§ ë©‹ì§„ ë‚ ì´ì—ìš”!" },
          { en: "When Pete gets home, he tells the real Goldie all about it.", ko: "í”¼íŠ¸ê°€ ì§‘ì— ëŒì•„ì™”ì„ ë•Œ, ê·¸ëŠ” ì§„ì§œ ê³¨ë””ì—ê²Œ ëª¨ë“  ê²ƒì„ ì´ì•¼ê¸°í•´ ì¤˜ìš”." }
        ];

        const QUIZ_DATA = [
          { q: "Where does Pete go at the beginning of the story?", options: ["To school", "To the pet store", "To the park", "To the library"], a: 1 },
          { q: "What pet does Pete choose?", options: ["A goldfish", "A bird", "A hamster", "A lizard"], a: 0 },
          { q: "What does Pete name his new pet?", options: ["Bob", "Benny", "Goldie", "Tom"], a: 2 },
          { q: "Why does Pete paint a picture of Goldie?", options: ["Because Goldie is hungry", "Because he cannot play or swim with her", "Because he needs money", "Because his mom told him to"], a: 1 },
          { q: "Who is the first person to ask Pete for a painting?", options: ["His mom", "Tom", "Benny", "Bob"], a: 3 },
          { q: "Where does Pete take a picture for show-and-tell?", options: ["To the park", "To the zoo", "To school", "To the store"], a: 2 },
          { q: "Why does Pete become very busy?", options: ["He has too much homework", "Everyone wants a painting of Goldie", "He has to clean his room", "Goldie gets sick"], a: 1 },
          { q: "What problem does Pete have near the end?", options: ["He runs out of paper", "He doesn't like painting", "He doesn't have time to paint for everyone", "Goldie runs away"], a: 2 },
          { q: "How does Pete solve the problem?", options: ["He stops painting", "He makes one huge painting outside", "He asks Bob to help", "He sells Goldie"], a: 1 },
          { q: "Who does Pete talk to when he gets home at the end?", options: ["His mom", "Bob", "The real Goldie", "The town mayor"], a: 2 }
        ];

        const WORD_DATA = [
          { en: "pet", desc: "ì§‘ì—ì„œ ê¸°ë¥´ëŠ” ë™ë¬¼", ko: "ì• ì™„ë™ë¬¼", ex: "He is going to get a pet." },
          { en: "store", desc: "ë¬¼ê±´ì„ íŒŒëŠ” ê³³", ko: "ê°€ê²Œ", ex: "Pete is going to the pet store." },
          { en: "goldfish", desc: "ì£¼í™©ìƒ‰ì´ë‚˜ ê¸ˆìƒ‰ì˜ ì‘ì€ ë¬¼ê³ ê¸°", ko: "ê¸ˆë¶•ì–´", ex: "Pete sees a goldfish." },
          { en: "paint", desc: "ê·¸ë¦¼ì„ ê·¸ë¦¬ë‹¤", ko: "ê·¸ë¦¬ë‹¤ (ë¬¼ê°ìœ¼ë¡œ)", ex: "Pete paints a picture of Goldie." },
          { en: "picture", desc: "ê·¸ë¦¼ì´ë‚˜ ì‚¬ì§„", ko: "ê·¸ë¦¼", ex: "He paints a picture for Bob." },
          { en: "feed", desc: "ìŒì‹ì„ ì£¼ë‹¤", ko: "ë¨¹ì´ë¥¼ ì£¼ë‹¤", ex: "He feeds her fish food." },
          { en: "friend", desc: "ì¹œí•˜ê²Œ ì§€ë‚´ëŠ” ì‚¬ëŒ", ko: "ì¹œêµ¬", ex: "Bob shows the painting to his friend." },
          { en: "class", desc: "í•™êµì—ì„œ ê°™ì´ ê³µë¶€í•˜ëŠ” ì¹œêµ¬ë“¤", ko: "ë°˜, í•™ê¸‰", ex: "Pete tells his class about Goldie." },
          { en: "homework", desc: "í•™êµì—ì„œ ë‚´ì£¼ëŠ” ì§‘ì—ì„œ í•˜ëŠ” ê³µë¶€", ko: "ìˆ™ì œ", ex: "He has to do homework." },
          { en: "town", desc: "ì‚¬ëŒë“¤ì´ ì‚¬ëŠ” ë§ˆì„", ko: "ë§ˆì„, ë™ë„¤", ex: "Everyone in town wants a painting." },
          { en: "idea", desc: "ì¢‹ì€ ìƒê°", ko: "ìƒê°, ì•„ì´ë””ì–´", ex: "Pete's mom has an idea!" },
          { en: "huge", desc: "ì•„ì£¼ í°", ko: "ê±°ëŒ€í•œ", ex: "He makes a huge painting." }
        ];

        const PHONICS_POOL = [
            { type: "father [a:]", list: ["mom", "bob", "lot", "not", "top"], color: "text-stone-600", bg: "bg-stone-100" },
            { type: "bus [ÊŒ]", list: ["just", "but", "fun", "bus", "run"], color: "text-amber-600", bg: "bg-amber-50" },
            { type: "apple [Ã¦]", list: ["that", "can", "has", "class", "happy"], color: "text-red-600", bg: "bg-red-50" },
            { type: "red [e]", list: ["pet", "get", "tell", "friend", "then"], color: "text-rose-600", bg: "bg-rose-50" },
            { type: "he [i:]", list: ["he", "she", "me", "be", "we"], color: "text-emerald-600", bg: "bg-emerald-50" },
            { type: "him [Éª]", list: ["fish", "his", "him", "big", "list"], color: "text-sky-600", bg: "bg-sky-50" },
            { type: "moon [u:]", list: ["room", "cool", "school", "do", "pool"], color: "text-purple-600", bg: "bg-purple-50" },
            { type: "book [ÊŠ]", list: ["look", "book", "good", "cook", "wood"], color: "text-indigo-600", bg: "bg-indigo-50" },
            { type: "bird [ÉœËr/É™r]", list: ["bird", "work", "her", "first", "girl"], color: "text-fuchsia-600", bg: "bg-fuchsia-50" },
            { type: "oh [oÊŠ]", list: ["home", "goldie", "go", "no", "know"], color: "text-orange-600", bg: "bg-orange-50" },
            { type: "now [aÊŠ]", list: ["town", "now", "wow", "how", "out"], color: "text-yellow-700", bg: "bg-yellow-50" },
            { type: "I [aÉª]", list: ["time", "like", "nice", "right", "kind"], color: "text-blue-600", bg: "bg-blue-50" },
            { type: "say [eÉª]", list: ["paint", "say", "way", "play", "make"], color: "text-pink-600", bg: "bg-pink-50" },
            { type: "boy [É”Éª]", list: ["boy", "toy", "joy", "coin", "enjoy"], color: "text-cyan-700", bg: "bg-cyan-50" },
            { type: "you [juË]", list: ["you", "cute", "huge", "use", "mule"], color: "text-violet-600", bg: "bg-violet-50" },
            { type: "ear [Éªr]", list: ["here", "ear", "hear", "near", "year"], color: "text-teal-600", bg: "bg-teal-50" },
            { type: "air [er]", list: ["there", "where", "air", "chair", "hair"], color: "text-lime-600", bg: "bg-lime-50" },
            { type: "or [É”r]", list: ["store", "or", "for", "more", "door"], color: "text-orange-800", bg: "bg-orange-100" },
            { type: "car [É‘Ër]", list: ["hard", "are", "car", "star", "far"], color: "text-red-800", bg: "bg-red-100" }
        ];

        // --- ìºë¦­í„° ë°ì´í„° ë° í…Œë§ˆ ---
        const CHARACTERS = {
            rabbit: {
                name: "Rabbit",
                colors: { bg: "bg-rose-50", text: "text-rose-400", button: "bg-rose-400", buttonHover: "hover:bg-rose-500", iconFill: "#C87F7F", iconStroke: "#8D6E63", face: "#E7A6A6", textHighlight: "text-pink-500" },
                emoji: "ğŸ°"
            },
            dog: {
                name: "Doggy",
                colors: { bg: "bg-sky-50", text: "text-sky-400", button: "bg-sky-400", buttonHover: "hover:bg-sky-500", iconFill: "#93C5FD", iconStroke: "#1E3A8A", face: "#FFFFFF", textHighlight: "text-sky-600" },
                emoji: "ğŸ¶"
            },
            cat: {
                name: "Kitty",
                colors: { bg: "bg-purple-50", text: "text-purple-400", button: "bg-purple-400", buttonHover: "hover:bg-purple-500", iconFill: "#A78BFA", iconStroke: "#4C1D95", face: "#E9D5FF", textHighlight: "text-purple-600" },
                emoji: "ğŸ±"
            },
            gecko: {
                name: "Gecko",
                colors: { bg: "bg-amber-50", text: "text-amber-600", button: "bg-amber-500", buttonHover: "hover:bg-amber-600", iconFill: "#D6C0A1", iconStroke: "#78350F", face: "#F5F5DC", textHighlight: "text-amber-700" },
                emoji: "ğŸ¦"
            }
        };

        // --- ì•„ì´ì½˜ ì»´í¬ë„ŒíŠ¸ ---
        const Icon = ({ name, size = 24, className = "" }) => {
            const icons = {
                Book: <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2zM22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" />,
                Quiz: <g><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12" y2="17"/></g>,
                Mic: <g><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></g>,
                Card: <g><rect x="2" y="7" width="20" height="14" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></g>,
                Vol: <g><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"/></g>,
                Refresh: <g><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></g>,
                ArrowR: <g><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></g>,
                ArrowL: <g><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></g>
            };
            return (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    {icons[name]}
                </svg>
            );
        };

        // --- ìºë¦­í„° SVG ì»´í¬ë„ŒíŠ¸ (ì„ íƒëœ ìºë¦­í„°ì— ë”°ë¼ ë‹¤ë¥¸ ê·¸ë¦¼ ë Œë”ë§) ---
        const CharacterSVG = ({ type }) => {
            const config = CHARACTERS[type];
            const { iconFill, iconStroke, face } = config.colors;
            
            // ê³µí†µ ìŠ¤íƒ€ì¼
            const svgStyle = { width: "100%", height: "100%" };

            if (type === 'rabbit') {
                return (
                    <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" style={svgStyle}>
                        {/* ë¡­ì´ì–´ í† ë¼ */}
                        <path d="M70,80 C30,80 20,175 55,175 C75,175 85,110 70,80 Z" fill={iconFill} />
                        <path d="M130,80 C170,80 180,175 145,175 C125,175 115,110 130,80 Z" fill={iconFill} />
                        <circle cx="100" cy="110" r="55" fill={face} />
                        <path d="M60,150 Q100,190 140,150 L140,220 L60,220 Z" fill={face} />
                        <circle cx="80" cy="105" r="5" fill="#5D4037" />
                        <circle cx="120" cy="105" r="5" fill="#5D4037" />
                        <path d="M95,120 Q100,125 105,120" stroke={iconStroke} strokeWidth="3" fill="none" strokeLinecap="round" />
                        <circle cx="100" cy="115" r="3" fill="#FFE0E0" opacity="0.8"/>
                        <circle cx="70" cy="120" r="6" fill="#FFCDD2" opacity="0.6" />
                        <circle cx="130" cy="120" r="6" fill="#FFCDD2" opacity="0.6" />
                    </svg>
                );
            } else if (type === 'dog') {
                return (
                     <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" style={svgStyle}>
                        {/* ì‹œë‚˜ëª¨ë¡¤ ìŠ¤íƒ€ì¼ ê°•ì•„ì§€ (í° ê·€) */}
                        <ellipse cx="50" cy="90" rx="45" ry="15" fill={face} stroke={iconFill} strokeWidth="2" transform="rotate(-10 50 90)" />
                        <ellipse cx="150" cy="90" rx="45" ry="15" fill={face} stroke={iconFill} strokeWidth="2" transform="rotate(10 150 90)" />
                        <ellipse cx="100" cy="110" rx="60" ry="45" fill={face} />
                        <path d="M60,145 Q100,180 140,145 L140,220 L60,220 Z" fill={face} />
                        <circle cx="80" cy="105" r="5" fill="#1E3A8A" />
                        <circle cx="120" cy="105" r="5" fill="#1E3A8A" />
                        <path d="M92,115 Q100,122 108,115" stroke={iconStroke} strokeWidth="3" fill="none" strokeLinecap="round" />
                        <circle cx="70" cy="115" r="8" fill="#FCA5A5" opacity="0.5" />
                        <circle cx="130" cy="115" r="8" fill="#FCA5A5" opacity="0.5" />
                    </svg>
                );
            } else if (type === 'cat') {
                return (
                     <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" style={svgStyle}>
                        {/* ë³´ë¼ìƒ‰ ê³ ì–‘ì´ (ë¾°ì¡±ê·€) */}
                        <polygon points="50,60 90,90 40,110" fill={iconFill} />
                        <polygon points="150,60 110,90 160,110" fill={iconFill} />
                        <circle cx="100" cy="110" r="50" fill={face} />
                        <path d="M65,150 Q100,190 135,150 L135,220 L65,220 Z" fill={face} />
                        <circle cx="85" cy="105" r="5" fill="#4C1D95" />
                        <circle cx="115" cy="105" r="5" fill="#4C1D95" />
                        <path d="M95,120 Q100,125 105,120" stroke={iconStroke} strokeWidth="2" fill="none" />
                        <line x1="60" y1="110" x2="30" y2="105" stroke={iconStroke} strokeWidth="2" opacity="0.5"/>
                        <line x1="60" y1="120" x2="30" y2="125" stroke={iconStroke} strokeWidth="2" opacity="0.5"/>
                        <line x1="140" y1="110" x2="170" y2="105" stroke={iconStroke} strokeWidth="2" opacity="0.5"/>
                        <line x1="140" y1="120" x2="170" y2="125" stroke={iconStroke} strokeWidth="2" opacity="0.5"/>
                    </svg>
                );
            } else if (type === 'gecko') {
                return (
                    <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" style={svgStyle}>
                        {/* í¬ë ˆìŠ¤í‹°ë“œ ê²Œì½” (ë² ì´ì§€, í°ëˆˆ, ì†ëˆˆì¹) */}
                        <path d="M70,160 Q100,200 130,160 L130,220 L70,220 Z" fill={face} />
                        {/* ë¨¸ë¦¬ - ì‚¼ê°í˜• ëŠë‚Œ */}
                        <path d="M50,110 Q100,40 150,110 Q100,140 50,110 Z" fill={face} stroke={iconFill} strokeWidth="2"/>
                        {/* ëˆˆ */}
                        <circle cx="65" cy="100" r="12" fill="#FEF3C7" stroke={iconFill} strokeWidth="2"/>
                        <rect x="63" y="92" width="4" height="16" rx="2" fill="#78350F" />
                        <circle cx="135" cy="100" r="12" fill="#FEF3C7" stroke={iconFill} strokeWidth="2"/>
                        <rect x="133" y="92" width="4" height="16" rx="2" fill="#78350F" />
                        {/* í¬ë ˆ ì†ëˆˆì¹(Crests) */}
                        <path d="M55,90 Q40,80 50,70" stroke={iconStroke} strokeWidth="3" fill="none" strokeLinecap="round" />
                        <path d="M145,90 Q160,80 150,70" stroke={iconStroke} strokeWidth="3" fill="none" strokeLinecap="round" />
                        {/* ì… */}
                        <path d="M85,125 Q100,135 115,125" stroke={iconStroke} strokeWidth="3" fill="none" strokeLinecap="round" />
                    </svg>
                );
            }
            return null;
        };


        // --- ì»´í¬ë„ŒíŠ¸ ---
        const IntroScreen = ({ onStart }) => {
            return (
                <div onClick={onStart} className="relative h-screen w-full bg-sky-100 cursor-pointer overflow-hidden">
                    {/* ë°°ê²½ ì´ë¯¸ì§€ (ì „ì²´ í™”ë©´ ê½‰ ì±„ìš°ê¸°) */}
                    <div className="absolute inset-0 z-0">
                         <img 
                            src="images/choyul.JPG" 
                            alt="Joyul" 
                            className="w-full h-full object-cover animate-fade-in"
                            onError={(e) => {
                                e.target.style.display = 'none'; // ì´ë¯¸ì§€ ì—†ìœ¼ë©´ ìˆ¨ê¹€
                                console.log("ì´ë¯¸ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. image/choyul.jpg ê²½ë¡œë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.");
                            }} 
                        />
                        {/* ì´ë¯¸ì§€ê°€ ì—†ì„ ê²½ìš°ë¥¼ ëŒ€ë¹„í•œ ëŒ€ì²´ ë°°ê²½ */}
                        <div className="w-full h-full absolute inset-0 -z-10 bg-sky-100 flex items-center justify-center text-sky-300">
                             ì´ë¯¸ì§€ ì¤€ë¹„ì¤‘
                        </div>
                    </div>

                    {/* ìƒë‹¨ í…ìŠ¤íŠ¸ ì˜¤ë²„ë ˆì´ */}
                    <div className="absolute top-16 w-full text-center z-10 px-4">
                        <h1 className="text-6xl font-bold text-sky-400 korean-font animate-pop text-outline drop-shadow-xl tracking-wide">
                            ì¡°ìœ¨ì´ëŠ” ìµœê³ !
                        </h1>
                    </div>

                    {/* í•˜ë‹¨ ì•ˆë‚´ ë¬¸êµ¬ */}
                    <div className="absolute bottom-12 w-full text-center z-10">
                        <div className="inline-block bg-white/80 backdrop-blur-sm px-6 py-2 rounded-full shadow-lg animate-bounce">
                            <span className="text-sky-600 font-bold font-fredoka">Tap to Start!</span>
                        </div>
                    </div>
                </div>
            );
        };

        
        const StoryTab = ({ accent, speak, isLoading }) => {
            return (
                <div className="space-y-4 pb-20 animate-fade-in">
                    <div className="flex justify-between items-center mb-6 bg-white p-4 rounded-xl shadow-sm border border-sky-100">
                        <div>
                            <h2 className="text-xl font-bold text-sky-600 font-fredoka">Let's Read!</h2>
                            <p className="text-xs text-slate-400">ë¬¸ì¥ì„ ëˆŒëŸ¬ ë“¤ì–´ë³´ì„¸ìš” (êµ¬ê¸€ AI ìŒì„±)</p>
                        </div>
                        <button onClick={() => speak(STORY_DATA.map(s => s.en).join(' '))} disabled={isLoading}
                            className="bg-orange-400 hover:bg-orange-500 text-white p-3 rounded-full shadow-md active:scale-95 transition disabled:opacity-50">
                            <Icon name="Vol" />
                        </button>
                    </div>
                    {STORY_DATA.map((item, idx) => (
                        <div key={idx} onClick={() => speak(item.en)} 
                             className="p-4 bg-white rounded-xl border border-transparent hover:border-sky-300 hover:shadow-md cursor-pointer transition active:bg-sky-50">
                            <p className="text-lg font-medium text-slate-800 mb-2 leading-relaxed font-fredoka">{item.en}</p>
                            <p className="text-slate-500 text-sm korean-font">{item.ko}</p>
                        </div>
                    ))}
                </div>
            );
        };

        const QuizTab = () => {
            const [current, setCurrent] = useState(0);
            const [score, setScore] = useState(0);
            const [selected, setSelected] = useState(null);
            const [finished, setFinished] = useState(false);

            const handleSelect = (idx) => {
                if (selected !== null) return;
                setSelected(idx);
                if (idx === QUIZ_DATA[current].a) setScore(s => s + 1);
            };

            const next = () => {
                if (current < QUIZ_DATA.length - 1) {
                    setCurrent(c => c + 1);
                    setSelected(null);
                } else {
                    setFinished(true);
                }
            };

            const retry = () => {
                setCurrent(0);
                setScore(0);
                setSelected(null);
                setFinished(false);
            };

            if (finished) return (
                <div className="flex flex-col items-center justify-center h-[60vh] animate-pop text-center">
                    <h2 className="text-3xl font-bold text-slate-800 mb-4 font-fredoka">Quiz Complete!</h2>
                    <div className="text-8xl mb-6">ğŸ†</div>
                    <p className="text-xl text-slate-600 mb-8 font-fredoka">
                        You scored <span className="text-sky-600 font-bold text-3xl">{score}</span> / {QUIZ_DATA.length}
                    </p>
                    <button onClick={retry} className="bg-sky-500 text-white px-8 py-3 rounded-full font-bold shadow-lg active:scale-95 transition flex items-center gap-2">
                        <Icon name="Refresh" /> Try Again
                    </button>
                </div>
            );

            const q = QUIZ_DATA[current];

            return (
                <div className="pb-20 animate-fade-in max-w-xl mx-auto">
                    <div className="flex justify-between items-center mb-6">
                        <span className="text-xs font-bold text-sky-600 bg-sky-100 px-3 py-1 rounded-full">Question {current + 1} / {QUIZ_DATA.length}</span>
                        <span className="text-xs font-bold text-slate-400">Score: {score}</span>
                    </div>
                    <div className="bg-white p-6 rounded-2xl shadow-sm border border-sky-100 mb-6">
                        <h3 className="text-xl font-bold text-slate-800 leading-relaxed font-fredoka">{q.q}</h3>
                    </div>
                    <div className="grid gap-3">
                        {q.options.map((opt, idx) => {
                            let style = "bg-white border-2 border-slate-100 text-slate-600 hover:border-sky-200";
                            let icon = null;
                            if (selected !== null) {
                                if (idx === q.a) { style = "bg-green-50 border-green-400 text-green-700 font-bold"; icon = "â­•"; }
                                else if (idx === selected) { style = "bg-red-50 border-red-300 text-red-700"; icon = "âŒ"; }
                                else { style = "opacity-50 border-slate-100"; }
                            }
                            return (
                                <button key={idx} onClick={() => handleSelect(idx)} disabled={selected !== null}
                                    className={`p-4 rounded-xl text-left font-fredoka transition-all flex justify-between items-center ${style}`}>
                                    <span>{opt}</span>
                                    {icon && <span>{icon}</span>}
                                </button>
                            );
                        })}
                    </div>
                    <div className="h-16 flex justify-end items-center mt-4">
                        {selected !== null && (
                            <button onClick={next} className="bg-sky-500 text-white px-6 py-3 rounded-xl font-bold shadow-md active:scale-95 transition flex items-center gap-2 animate-pop">
                                {current === QUIZ_DATA.length - 1 ? "See Result" : "Next"} <Icon name="ArrowR" />
                            </button>
                        )}
                    </div>
                </div>
            );
        };

        const PhonicsTab = ({ speak, isLoading }) => {
            const [selectedPhonics, setSelectedPhonics] = useState([]);

            const getRandomPhonics = useCallback(() => {
                const shuffled = [...PHONICS_POOL].sort(() => 0.5 - Math.random());
                setSelectedPhonics(shuffled.slice(0, 3));
            }, []);

            useEffect(() => {
                getRandomPhonics();
            }, [getRandomPhonics]);

            if (selectedPhonics.length === 0) return null;

            return (
                <div className="pb-20 animate-fade-in space-y-6">
                    <div className="flex justify-between items-end mb-2">
                        <div>
                            <h2 className="text-xl font-bold text-slate-700 korean-font">ì†Œë¦¬ ì—°ìŠµí•˜ê¸°</h2>
                            <p className="text-sm text-slate-500 korean-font">ë¹„ìŠ·í•œ ì†Œë¦¬ë¥¼ ê°€ì§„ ë‹¨ì–´ë“¤</p>
                        </div>
                        <button onClick={getRandomPhonics} className="text-xs bg-slate-200 text-slate-600 px-3 py-2 rounded-lg hover:bg-slate-300 transition flex gap-1 items-center font-bold">
                            <Icon name="Refresh" size={12} /> Shuffle
                        </button>
                    </div>

                    {selectedPhonics.map((group, idx) => (
                        <div key={idx} className={`${group.bg} p-5 rounded-2xl shadow-sm border border-transparent hover:border-sky-100 transition`}>
                            <div className="flex items-center gap-2 mb-4">
                                <span className="bg-white/80 p-2 rounded-lg shadow-sm text-lg">ğŸ”Š</span>
                                <h3 className={`font-bold ${group.color} text-lg uppercase tracking-wide font-fredoka`}>
                                    {group.type}
                                </h3>
                            </div>
                            
                            <div className="flex flex-wrap gap-2">
                                {group.list.map((w, wIdx) => (
                                    <button key={wIdx} onClick={() => speak(w)} disabled={isLoading}
                                        className="bg-white border border-slate-200 px-4 py-2 rounded-xl text-slate-700 font-medium hover:scale-105 active:scale-95 transition flex gap-2 items-center shadow-sm disabled:opacity-50">
                                        {w} <Icon name="Vol" size={12} className="text-slate-300" />
                                    </button>
                                ))}
                            </div>
                        </div>
                    ))}
                </div>
            );
        };

        // --- ìˆ˜ì •ëœ CardTab: ìºë¦­í„° ì„ íƒ ê¸°ëŠ¥ ì¶”ê°€ ---
        const CardTab = ({ speak, isLoading }) => {
            const [shuffledCards, setShuffledCards] = useState([]);
            const [idx, setIdx] = useState(0);
            const [face, setFace] = useState(0);
            const [character, setCharacter] = useState('rabbit'); // ìºë¦­í„° ìƒíƒœ ì¶”ê°€

            useEffect(() => {
                const shuffled = [...WORD_DATA].sort(() => Math.random() - 0.5);
                setShuffledCards(shuffled);
            }, []);

            if (shuffledCards.length === 0) return null;

            const card = shuffledCards[idx];
            const flip = () => setFace((f) => (f + 1) % 3);
            const prev = (e) => { e.stopPropagation(); if(idx > 0) { setIdx(i => i-1); setFace(0); } };
            const next = (e) => { e.stopPropagation(); if(idx < shuffledCards.length - 1) { setIdx(i => i+1); setFace(0); } };
            
            // í˜„ì¬ í…Œë§ˆ ìƒ‰ìƒ ê°€ì ¸ì˜¤ê¸°
            const theme = CHARACTERS[character].colors;

            return (
                <div className="flex flex-col min-h-[calc(100vh-140px)] animate-fade-in max-w-sm mx-auto">
                    
                    {/* ìºë¦­í„° ì„ íƒê¸° */}
                    <div className="flex justify-center gap-4 mb-6">
                        {Object.keys(CHARACTERS).map((key) => (
                            <button 
                                key={key}
                                onClick={() => setCharacter(key)}
                                className={`w-10 h-10 rounded-full text-xl flex items-center justify-center transition-all shadow-sm border-2
                                    ${character === key ? 'scale-110 border-sky-400 bg-white' : 'border-transparent bg-slate-100 opacity-60 grayscale'}`}
                            >
                                {CHARACTERS[key].emoji}
                            </button>
                        ))}
                    </div>

                    <div onClick={flip} className={`relative flex-1 bg-white rounded-[3rem] shadow-xl border-8 border-white cursor-pointer active:scale-[0.98] transition-transform overflow-hidden flex flex-col items-center justify-center text-center p-6 mb-8 group`}>
                        
                        {/* ë™ì  ìºë¦­í„° ë°°ê²½ SVG */}
                        <div className="absolute bottom-[-10px] right-[-10px] w-56 h-56 opacity-20 pointer-events-none transition-opacity group-hover:opacity-30">
                            <CharacterSVG type={character} />
                        </div>

                        {/* ìƒë‹¨ ì¸ë””ì¼€ì´í„° */}
                        <div className="absolute top-8 flex gap-2">
                            {[0,1,2].map(i => <div key={i} className={`w-2 h-2 rounded-full transition-colors ${face === i ? theme.button : 'bg-slate-200'}`} />)}
                        </div>
                        
                        {/* ìŠ¤í”¼ì»¤ ë²„íŠ¼ (ë™ì  ìƒ‰ìƒ) */}
                        <button onClick={(e) => {e.stopPropagation(); speak(card.en);}} disabled={isLoading}
                            className={`absolute top-6 right-6 p-3 ${theme.bg} ${theme.text} rounded-full hover:opacity-80 transition z-10 disabled:opacity-50`}>
                            <Icon name="Vol" />
                        </button>

                        <div className="z-10 w-full animate-pop">
                            {face === 0 && (
                                <>
                                    <h2 className="text-5xl font-bold text-slate-700 mb-4 font-fredoka tracking-tight">{card.en}</h2>
                                    <p className={`${theme.text} font-bold text-sm uppercase tracking-widest`}>Tap for Hint</p>
                                </>
                            )}
                            {face === 1 && (
                                <>
                                    <h2 className="text-3xl font-bold text-slate-400 mb-8 font-fredoka opacity-50">{card.en}</h2>
                                    <div className={`${theme.bg} ${theme.text} p-4 rounded-xl font-bold text-xl korean-font border border-white/50 shadow-sm`}>
                                        "{card.desc}"
                                    </div>
                                </>
                            )}
                            {face === 2 && (
                                <>
                                    <h2 className={`text-4xl font-bold ${theme.textHighlight} mb-2 korean-font`}>{card.ko}</h2>
                                    <p className="text-slate-400 font-fredoka mb-6">{card.en}</p>
                                    <div className="bg-slate-50 text-slate-600 p-4 rounded-xl italic border border-slate-100">
                                        "{card.ex}"
                                    </div>
                                </>
                            )}
                        </div>
                    </div>

                    {/* ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ (ë™ì  ìƒ‰ìƒ) */}
                    <div className="flex items-center justify-between px-4">
                        <button onClick={prev} disabled={idx === 0} 
                            className={`p-4 bg-white ${theme.text} rounded-full shadow-lg disabled:opacity-30 hover:${theme.bg} transition active:scale-95`}>
                            <Icon name="ArrowL" />
                        </button>
                        
                        <span className={`font-bold ${theme.textHighlight} font-fredoka text-lg`}>{idx + 1} / {shuffledCards.length}</span>
                        
                        <button onClick={next} disabled={idx === shuffledCards.length - 1} 
                            className={`p-4 ${theme.button} ${theme.buttonHover} text-white rounded-full shadow-lg disabled:opacity-30 transition active:scale-95`}>
                            <Icon name="ArrowR" />
                        </button>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [tab, setTab] = useState('story');
            const [accent, setAccent] = useState('en-US');
            const [isLoading, setIsLoading] = useState(false);

            // Google TTS Call Logic
            const speak = useCallback(async (text) => {
                if (!GOOGLE_API_KEY || GOOGLE_API_KEY === "YOUR_GOOGLE_API_KEY_HERE") {
                    alert("Google API Keyê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì½”ë“œì—ì„œ í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                    return;
                }

                setIsLoading(true);
                let voiceName = 'en-US-Neural2-F'; 
                if (accent === 'en-GB') voiceName = 'en-GB-Neural2-A'; 
                if (accent === 'en-AU') voiceName = 'en-AU-Neural2-C'; 

                try {
                    const response = await fetch(`https://texttospeech.googleapis.com/v1/text:synthesize?key=${GOOGLE_API_KEY}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            input: { text: text },
                            voice: { languageCode: accent, name: voiceName },
                            audioConfig: { audioEncoding: 'MP3' }
                        })
                    });

                    const data = await response.json();

                    if (data.error) {
                        console.error("API Error:", data.error);
                        alert("ìŒì„± ì¬ìƒ ì˜¤ë¥˜: " + data.error.message);
                    } else if (data.audioContent) {
                        const audio = new Audio("data:audio/mp3;base64," + data.audioContent);
                        audio.play();
                    }
                } catch (error) {
                    console.error("Network Error:", error);
                    alert("ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
                } finally {
                    setIsLoading(false);
                }
            }, [accent]);

            const TABS = [
                { id: 'story', label: 'Story', icon: 'Book' },
                { id: 'quiz', label: 'Quiz', icon: 'Quiz' },
                { id: 'phonics', label: 'Phonics', icon: 'Mic' },
                { id: 'cards', label: 'Cards', icon: 'Card' },
            ];

            return (
                <div className="max-w-2xl mx-auto min-h-screen flex flex-col bg-sky-50">
                    <div className="bg-white/80 backdrop-blur-md sticky top-0 z-50 px-4 py-3 shadow-sm border-b border-sky-100">
                        <div className="flex justify-between items-center mb-3">
                            <h1 className="text-2xl font-bold text-sky-500 flex items-center gap-2 font-fredoka">
                                <Icon name="Book" /> Pete's Class
                            </h1>
                            <select value={accent} onChange={e => setAccent(e.target.value)} className="text-xs bg-slate-100 px-2 py-1 rounded-md font-bold text-slate-500 outline-none">
                                <option value="en-US">ğŸ‡ºğŸ‡¸ US</option>
                                <option value="en-GB">ğŸ‡¬ğŸ‡§ UK</option>
                                <option value="en-AU">ğŸ‡¦ğŸ‡º AU</option>
                            </select>
                        </div>
                        <div className="flex gap-1 bg-sky-100/50 p-1 rounded-xl overflow-x-auto hide-scrollbar">
                            {TABS.map(t => (
                                <button key={t.id} onClick={() => setTab(t.id)}
                                    className={`flex-1 py-2 px-3 rounded-lg flex items-center justify-center gap-1.5 text-xs font-bold transition-all whitespace-nowrap
                                    ${tab === t.id ? 'bg-sky-500 text-white shadow-sm' : 'text-sky-600 hover:bg-sky-200/50'}`}>
                                    <Icon name={t.icon} size={16} /> {t.label}
                                </button>
                            ))}
                        </div>
                    </div>
                    <div className="flex-1 p-4 overflow-y-auto">
                        {tab === 'story' && <StoryTab accent={accent} speak={speak} isLoading={isLoading} />}
                        {tab === 'quiz' && <QuizTab />}
                        {tab === 'phonics' && <PhonicsTab speak={speak} isLoading={isLoading} />}
                        {tab === 'cards' && <CardTab speak={speak} isLoading={isLoading} />}
                    </div>
                </div>
            );
        };

const Main = () => {
    const [showIntro, setShowIntro] = useState(true);

    if (showIntro) {
        return <IntroScreen onStart={() => setShowIntro(false)} />;
    }

    return <App />;
};

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<Main />);
    </script>
</body>
</html>
