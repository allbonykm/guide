<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ìœ¨ì´ì˜ ì—­ì‚¬ì—¬í–‰:ë¶ˆê½ƒë†€ì´ì™€ í™”ì•½</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Jua&family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #1a1a1a;
            color: #333;
            overflow: hidden; /* ìŠ¤í¬ë¡¤ ë°©ì§€ */
            touch-action: manipulation;
        }

        .font-comic {
            font-family: 'Jua', sans-serif;
        }

        /* ë¶ˆê½ƒ ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes burn {
            0% { transform: scale(1); filter: brightness(100%); }
            50% { transform: scale(1.1); filter: brightness(120%); }
            100% { transform: scale(1); filter: brightness(100%); }
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        .btn-fire {
            animation: burn 1.5s infinite ease-in-out;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-fire:active {
            transform: scale(0.9);
        }

        .btn-quiz {
            animation: float 2s infinite ease-in-out;
        }

        /* í…ìŠ¤íŠ¸ ë°•ìŠ¤ ìŠ¤íƒ€ì¼ (ì „ìì±… ëŠë‚Œ) */
        .text-box {
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 20px 20px 0 0;
            box-shadow: 0 -4px 10px rgba(0,0,0,0.2);
        }

        /* ì´ë¯¸ì§€ ì»¨í…Œì´ë„ˆ */
        .img-container {
            width: 100%;
            height: 100%;
            background-color: #2d3748;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }

        .img-cover {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .img-fit {
            width: 100%;
            height: 100%;
            object-fit: contain;
            background-color: #000;
        }

        /* í˜ì´ë“œ íš¨ê³¼ */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body class="h-screen w-screen flex flex-col justify-center items-center">

    <div id="app" class="w-full h-full max-w-md bg-white relative shadow-2xl overflow-hidden flex flex-col">
        <!-- ì»¨í…ì¸ ê°€ ì—¬ê¸°ì— ë Œë”ë§ ë©ë‹ˆë‹¤ -->
    </div>

    <script>
        // ë°ì´í„° ì •ì˜
        const storyData = [
            {
                type: 'cover',
                image: 'images/fire1.jpg',
                alt: 'í‘œì§€: í™”ì•½ì˜ ë¹„ë°€'
            },
            {
                type: 'intro',
                image: 'images/fire2.jpg',
                title: 'ë“±ì¥ì¸ë¬¼ ì†Œê°œ',
                content: `
                    <p class="mb-2"><strong class="text-red-500">ì¡°ìœ¨ (8ì„¸)</strong>: 2025ë…„ ì²­ê³¡ì´ˆë“±í•™êµ 1í•™ë…„ 5ë°˜ 17ë²ˆ. í˜¸ê¸°ì‹¬ ì™•ì„±í•˜ê³  ë°˜ì§ì´ëŠ” ê±¸ ì¢‹ì•„í•˜ëŠ” ë©‹ì§„ ì†Œë…€.</p>
                    <p class="mb-2"><strong class="text-amber-700">ì† í• ì•„ë²„ì§€ (ì†ì‚¬ë§‰)</strong>: ì•„ì£¼ ë¨¼ ì˜›ë‚ (ë‹¹ë‚˜ë¼), ì•½ì„ ë§Œë“œëŠ” ì˜ì‚¬ í• ì•„ë²„ì§€. ì‹¤ìˆ˜ íˆ¬ì„±ì´ì§€ë§Œ ì—´ì •ì ì´ë‹¤.</p>
                    <p><strong class="text-orange-500">ë¶ˆê½ƒ ìš”ì • 'íŒŒíŒ¡'</strong>: ë¶ˆê½ƒë†€ì´ì—ì„œ íŠ€ì–´ë‚˜ì˜¨ ì¥ë‚œê¾¸ëŸ¬ê¸° ë¶ˆë˜¥ ìš”ì •.</p>
                `
            },
            {
                type: 'story',
                image: 'images/fire3.jpg',
                title: '1ì¥: ë°¤í•˜ëŠ˜ì— í•€ ê½ƒ',
                sub: '(2025ë…„ ì²­í˜„ë§ˆì„ ì¶•ì œ ë‚  ë°¤)',
                content: `
                    <p class="mb-2"><span class="font-bold text-red-500">ìœ¨:</span> (ë°¤í•˜ëŠ˜ì„ ì˜¬ë ¤ë‹¤ë³´ë©°) "ì™€ì•„! ì—„ë§ˆ, ì €ê¸° ë´ìš”! í•˜ëŠ˜ì— ë³´ì„ì´ í„°ì§€ëŠ” ê²ƒ ê°™ì•„ìš”! ë„ˆë¬´ ì˜ˆì˜ë‹¤!"</p>
                    <p class="mb-2"><span class="font-bold text-orange-500">íŒŒíŒ¡:</span> (ìœ¨ì´ì˜ ì½”ì•ì—ì„œ í‘! ë‚˜íƒ€ë‚˜ë©°) "ì•ˆë…•? ë‚œ ë¶ˆê½ƒ ìš”ì • 'íŒŒíŒ¡'ì´ì•¼! ë‚´ê°€ ì˜ˆì˜ë‹ˆ?"</p>
                    <p class="mb-2"><span class="font-bold text-red-500">ìœ¨:</span> "ì—„ë§ˆì•¼! ê¹œì§ì´ì•¼. ë„ˆëŠ” ëˆ„êµ¬ë‹ˆ?"</p>
                    <p class="mb-2"><span class="font-bold text-orange-500">íŒŒíŒ¡:</span> "íˆíˆ, ë‚˜ëŠ” ë¶ˆê½ƒ ì†ì— ìˆ¨ì–´ìˆëŠ” ë¹„ë°€ì„ ì•Œê³  ìˆì§€. ìœ¨ì•„, ì € í™”ë ¤í•œ ë¶ˆê½ƒì´ ì–´ë–»ê²Œ ë§Œë“¤ì–´ì§€ëŠ”ì§€ ê¶ê¸ˆí•˜ì§€ ì•Šì•„? ë‚˜ë‘ ê°™ì´ ë¹„ë°€ì„ ì°¾ìœ¼ëŸ¬ ê°ˆë˜?"</p>
                    <p class="mb-2"><span class="font-bold text-red-500">ìœ¨:</span> "ì‘! ê¶ê¸ˆí•´! ê°™ì´ ê°ˆë˜!"</p>
                    <p><span class="font-bold text-orange-500">íŒŒíŒ¡:</span> "ì¢‹ì•˜ì–´! ì, ë‚´ ì†ì„ ì¡ì•„! í‘í‘ íŒŒë¼íŒŒë¼ íŒ¡íŒ¡! ê³¼ê±°ë¡œ ì“©~!"</p>
                `
            },
            {
                type: 'story',
                image: 'images/fire4.jpg',
                title: '2ì¥: ì•—, ëƒ„ìƒˆ! ì´ê²Œ ë¬´ìŠ¨ ëƒ„ìƒˆì•¼?',
                sub: '(7ì„¸ê¸° ë‹¹ë‚˜ë¼, ì–´ëŠ ê¹Šì€ ì‚°ì† ì˜¤ë‘ë§‰)',
                content: `
                    <p class="mb-2"><span class="font-bold text-red-500">ìœ¨:</span> (ì—‰ë©ë°©ì•„ë¥¼ ì°§ìœ¼ë©°) "ì•„ì•¼! ì–´? ì—¬ê¸°ê°€ ì–´ë””ì§€? ìœ¼ì•…, ê·¼ë° ì´ê²Œ ë¬´ìŠ¨ ëƒ„ìƒˆì•¼? ë°©ê·€ ëƒ„ìƒˆ ê°™ì•„!"</p>
                    <p class="mb-2"><span class="font-bold text-amber-700">ì† í• ì•„ë²„ì§€:</span> (ê²€ì€ ì—°ê¸° ì†ì—ì„œ ì½œë¡ê±°ë¦¬ë©°) "ì½œë¡ì½œë¡! ì•„ì´êµ¬, ë˜ ì‹¤íŒ¨êµ¬ë‚˜. ëŠ™ì§€ ì•Šê³  ì˜ì›íˆ ì‚¬ëŠ” ì•½ì„ ë§Œë“¤ê¸°ê°€ ì´ë ‡ê²Œ í˜ë“¤ë‹¤ë‹ˆ..."</p>
                    <p class="mb-2"><span class="font-bold text-red-500">ìœ¨:</span> "í• ì•„ë²„ì§€ëŠ” ëˆ„êµ¬ì„¸ìš”? ê·¸ë¦¬ê³  ì´ ë…¸ë€ ê°€ë£¨ëŠ” ë­ì˜ˆìš”? ëƒ„ìƒˆê°€ ì§€ë…í•´ìš”!"</p>
                    <p class="mb-2"><span class="font-bold text-amber-700">ì† í• ì•„ë²„ì§€:</span> "ë‚˜ëŠ” ì˜ì‚¬ 'ì†ì‚¬ë§‰'ì´ë€ë‹¤. ê·¸ ë…¸ë€ ê±´ <strong class='text-yellow-600'>'ìœ í™©'</strong>ì´ì•¼. ëƒ„ìƒˆëŠ” ì¢€ ë‚˜ì§€ë§Œ ë¶ˆì„ ì•„ì£¼ ì˜ ë¶™ê²Œ ë„ì™€ì£¼ëŠ” ë¶€ì‹¯ëŒ ê°™ì€ ë…€ì„ì´ì§€."</p>
                    <p class="mb-2"><span class="font-bold text-red-500">ìœ¨:</span> "ìœ í™©? ëƒ„ìƒˆë‚˜ëŠ” ë…¸ë€ ê°€ë£¨êµ¬ë‚˜! ê·¸ëŸ¼ ì € ê²€ì€ ê±´ìš”?"</p>
                    <p><span class="font-bold text-amber-700">ì† í• ì•„ë²„ì§€:</span> "ì €ê±´ ë‚˜ë¬´ë¥¼ íƒœì›Œ ë§Œë“  <strong class='text-gray-800'>'ìˆ¯ê°€ë£¨(íƒ„ì†Œ)'</strong>ë€ë‹¤. ê·¸ë¦¬ê³  ì €ê¸° í•˜ì–€ ê°€ë£¨ëŠ” <strong class='text-gray-500'>'ì´ˆì„(ì§ˆì‚°ì¹¼ë¥¨)'</strong>ì´ì§€. ì´ ì´ˆì„ì´ ì•„ì£¼ ì¤‘ìš”í•´. ë¶ˆê½ƒì´ 'íŒŒë°”ë°•!' í•˜ê³  íŠ€ì–´ì˜¤ë¥´ê²Œ ë§Œë“¤ê±°ë“ ."</p>
                `
            },
            {
                type: 'story',
                image: 'images/fire5.jpg',
                title: '3ì¥: 3ëŒ€ 2ëŒ€ 1ì˜ ë¹„ë°€ ë ˆì‹œí”¼',
                content: `
                    <p class="mb-2"><span class="font-bold text-amber-700">ì† í• ì•„ë²„ì§€:</span> "ìœ¨ì•„, ë‚´ê°€ í˜ì´ ì—†ìœ¼ë‹ˆ ë„¤ê°€ ì¢€ ë„ì™€ì£¼ë ´. ì•½ì„ ë§Œë“¤ë ¤ë©´ ë¹„ìœ¨ì´ ì¤‘ìš”í•´!"</p>
                    <p class="mb-2"><span class="font-bold text-red-500">ìœ¨:</span> "ë„¤! ì œê°€ í• ê²Œìš”. ì–´ë–»ê²Œ ì„ìœ¼ë©´ ë¼ìš”?"</p>
                    <p class="mb-2"><span class="font-bold text-amber-700">ì† í• ì•„ë²„ì§€:</span> "ì, ë…¸ë˜ë¥¼ ë¶€ë¥´ë©´ì„œ ë„£ì–´ë³´ì!"</p>
                    <div class="bg-yellow-50 p-3 rounded-lg my-2 border border-yellow-200">
                        <p class="font-comic text-center text-lg text-orange-600">ğŸµ í• ì•„ë²„ì§€ì˜ ì¿µì§ì¿µì§ ë ˆì‹œí”¼ ì†¡ ğŸµ</p>
                        <p class="text-center">ê²€ì€ìƒ‰ ìˆ¯ê°€ë£¨ëŠ” ë“¬ì§í•˜ê²Œ ì„¸ ìŠ¤í‘¼ (3)!</p>
                        <p class="text-center">í•˜ì–€ìƒ‰ ì´ˆì„ì€ ì§œë¦¿í•˜ê²Œ ë‘ ìŠ¤í‘¼ (2)!</p>
                        <p class="text-center">ë…¸ë€ìƒ‰ ìœ í™©ì€ ëƒ„ìƒˆë‚˜ë„ í•œ ìŠ¤í‘¼ (1)!</p>
                        <p class="text-center font-bold">3 ëŒ€ 2 ëŒ€ 1ë¡œ ì„ì–´ì„ì–´~ ì‰í‚·ì‰í‚·!</p>
                    </div>
                    <p class="mb-2"><span class="font-bold text-red-500">ìœ¨:</span> (ì‹ ë‚˜ì„œ ì„ìœ¼ë©°) "ê²€ì€ ê±° 3ë²ˆ! í•˜ì–€ ê±° 2ë²ˆ! ë…¸ë€ ê±° 1ë²ˆ! ë‹¤ ì„ì—ˆì–´ìš” í• ì•„ë²„ì§€!"</p>
                    <p class="mb-2"><span class="font-bold text-amber-700">ì† í• ì•„ë²„ì§€:</span> "ì¢‹ì•„! ì´ì œ ì—¬ê¸°ì— ë¶ˆê¸°ìš´ì„ ì‚´ì§ ì£¼ë©´... ì˜ì›íˆ ì‚¬ëŠ” ì•½ì´ ë˜ê² ì§€?"</p>
                    <p class="text-sm text-gray-500 text-center">(í• ì•„ë²„ì§€ê°€ ê·¸ë¦‡ì— ë¶ˆì”¨ë¥¼ ê°€ê¹Œì´ ëŒ€ëŠ” ìˆœê°„!)</p>
                `
            },
            {
                type: 'story',
                image: 'images/fire6.jpg',
                title: '4ì¥: ì•½ì´ ì•„ë‹ˆë¼ í­íƒ„ì´ì—ˆì–´?!',
                content: `
                    <p class="mb-2"><span class="font-bold text-orange-500">íŒŒíŒ¡:</span> "ìœ¨ì•„! ê·€ ë§‰ì•„!"</p>
                    <p class="mb-2"><span class="font-bold text-red-500">ìœ¨:</span> "ì–´?!"</p>
                    <p class="text-center text-3xl font-comic text-red-600 my-4 animate-bounce">í¼ì–´ì–´ì—‰!!! ì¾…!!!</p>
                    <p class="mb-2 bg-gray-100 p-2 rounded">ì˜¤ë‘ë§‰ ì§€ë¶•ì´ ë“¤ì©ê±°ë¦¬ê³ , ê·¸ë¦‡ì— ë‹´ê¸´ ê°€ë£¨ë“¤ì´ ë¬´ì§€ê°œìƒ‰ ë¶ˆê½ƒì„ ë‚´ë¿œìœ¼ë©° íŠ€ì–´ ì˜¬ëì–´ìš”.</p>
                    <p class="mb-2"><span class="font-bold text-amber-700">ì† í• ì•„ë²„ì§€:</span> "ìœ¼ì•„ì•…! ë‚´ ìˆ˜ì—¼ ë‹¤ íƒ”ë„¤!"</p>
                    <p class="mb-2"><span class="font-bold text-red-500">ìœ¨:</span> "êº„ì•…! í• ì•„ë²„ì§€, ì•½ì´ í­ë°œí–ˆì–´ìš”! ê·¼ë°... ë¶ˆê½ƒì´ ë„ˆë¬´ ì˜ˆë»ìš”!"</p>
                    <p class="mb-2"><span class="font-bold text-orange-500">íŒŒíŒ¡:</span> (ê¹”ê¹” ì›ƒìœ¼ë©°) "ë´¤ì§€? í• ì•„ë²„ì§€ëŠ” ì˜¤ë˜ ì‚¬ëŠ” ì•½ì„ ë§Œë“¤ë ¤ë‹¤ê°€ ìš°ì—°íˆ <strong class='text-red-600'>'í™”ì•½'</strong>ì„ ë°œëª…í•˜ê²Œ ëœ ê±°ì•¼! í‘ í„°ì§€ë©´ì„œ ë†’ì€ ì—´ì´ë‘ ë¹›ì„ ë‚´ëŠ” ê°€ë£¨, ê·¸ê²Œ ë°”ë¡œ í™”ì•½ì´ì§€!"</p>
                    <p class="mb-2"><span class="font-bold text-red-500">ìœ¨:</span> "ì•„í•˜! ìˆ¯, ì´ˆì„, ìœ í™©ì„ ì„ìœ¼ë‹ˆê¹Œ 'í‘'í•˜ê³  í„°ì§€ëŠ” í™”ì•½ì´ ë˜ì—ˆêµ¬ë‚˜! ì˜›ë‚ ì—ëŠ” ì´ê±¸ë¡œ ë¬´ê¸°ë¥¼ ë§Œë“¤ê±°ë‚˜ ê³µì‚¬ë¥¼ í–ˆì§€ë§Œ, ì§€ê¸ˆì€ ì˜ˆìœ ë¶ˆê½ƒë†€ì´ê°€ ëœ ê±°ë„¤?"</p>
                    <p><span class="font-bold text-amber-700">ì† í• ì•„ë²„ì§€:</span> (ê²€ëŒ•ì´ ë¬»ì€ ì–¼êµ´ë¡œ) "í—ˆí—ˆ, ì•½ì€ ì‹¤íŒ¨í–ˆì§€ë§Œ ì—„ì²­ë‚œ ê±¸ ë°œê²¬í–ˆêµ¬ë¨¼!"</p>
                `
            },
            {
                type: 'quiz_intro',
                image: 'images/fire7.jpg',
                title: '5ì¥: ìœ¨ì´ì˜ í€´ì¦ˆ íƒ€ì„!',
                sub: '(ë‹¤ì‹œ 2025ë…„ìœ¼ë¡œ ëŒì•„ì˜¨ ìœ¨ì´)',
                content: `
                    <p class="mb-4"><span class="font-bold text-orange-500">íŒŒíŒ¡:</span> "ìœ¨ì•„, ì˜¤ëŠ˜ ì—¬í–‰ ì–´ë• ì–´? ëŒì•„ê°€ê¸° ì „ì— í€´ì¦ˆë¥¼ ë§í˜€ì•¼ ì§‘ìœ¼ë¡œ ë³´ë‚´ì¤„ ê±°ì•¼!"</p>
                    <p><span class="font-bold text-red-500">ìœ¨:</span> "ìì‹  ìˆì–´! ë¬¸ì œ ë‚´ë´!"</p>
                `
            },
            {
                type: 'ending',
                image: 'images/fire8.jpg',
                alt: 'ë'
            }
        ];

        const quizData = [
            {
                question: "í™”ì•½ì„ ì²˜ìŒ ë§Œë“  ì‚¬ëŒì€ ë¹µì„ êµ½ë‹¤ê°€ ìš°ì—°íˆ ë°œê²¬í–ˆë‹¤?",
                answer: false,
                explanation: "ë‹¹ë‚˜ë¼ì˜ 'ì†ì‚¬ë§‰' í• ì•„ë²„ì§€ê°€ ë¶ˆë¡œì¥ìƒ(ì˜¤ë˜ ì‚¬ëŠ”) ì•½ì„ ë§Œë“¤ë ¤ë‹¤ê°€ ìš°ì—°íˆ ë°œê²¬í–ˆì–´!"
            },
            {
                question: "í™”ì•½ ì¬ë£Œ ì¤‘ 'ìœ í™©'ì€ í–¥ê¸°ë¡œìš´ ê½ƒ ëƒ„ìƒˆê°€ ë‚œë‹¤?",
                answer: false,
                explanation: "ìœ í™©ì€ ë°©ê·€ ëƒ„ìƒˆ ê°™ì€ ì§€ë…í•œ ëƒ„ìƒˆê°€ ë‚˜. í•˜ì§€ë§Œ ë¶ˆì„ ì˜ ë¶™ê²Œ ë„ì™€ì£¼ì§€!"
            },
            {
                question: "í™”ì•½ì„ ë§Œë“œëŠ” í™©ê¸ˆ ë¹„ìœ¨ì€<br>ìˆ¯ : ì´ˆì„ : ìœ í™© = 3 : 2 : 1 ì´ë‹¤?",
                answer: true,
                explanation: "ê²€ì€ ìˆ¯ 3ë²ˆ, í•˜ì–€ ì´ˆì„ 2ë²ˆ, ë…¸ë€ ìœ í™© 1ë²ˆ! ì´ ë…¸ë˜ë¥¼ ê¸°ì–µí•´!"
            }
        ];

        // ìƒíƒœ ê´€ë¦¬
        let currentState = {
            pageIndex: 0,
            quizIndex: 0,
            quizStatus: 'question' // question, result, explanation
        };

        const app = document.getElementById('app');

        // ë©”ì¸ ë Œë”ë§ í•¨ìˆ˜
        function render() {
            app.innerHTML = ''; // ì´ˆê¸°í™”
            
            // 1. í€´ì¦ˆ í˜ì´ì§€ê°€ ì•„ë‹Œ ê²½ìš° (ìŠ¤í† ë¦¬, í‘œì§€, ì—”ë”©)
            if (currentState.pageIndex < storyData.length) {
                const page = storyData[currentState.pageIndex];
                
                if (page.type === 'cover') {
                    renderCover(page);
                } else if (page.type === 'ending') {
                    renderEnding(page);
                } else if (page.type === 'quiz_intro') {
                    renderStoryPage(page, true);
                } else {
                    renderStoryPage(page, false);
                }
            } 
            // 2. í€´ì¦ˆ ì§„í–‰ ì¤‘
            else if (currentState.pageIndex === storyData.length) {
                renderQuiz();
            }
        }

        // --- í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸ë“¤ ---

        function renderCover(data) {
            const div = document.createElement('div');
            div.className = "w-full h-full relative cursor-pointer fade-in";
            div.onclick = nextPage;
            div.innerHTML = `
                <div class="img-container">
                    <img src="${data.image}" class="img-cover" alt="${data.alt}" onerror="this.parentElement.innerHTML='<div class=\\'w-full h-full bg-red-900 flex flex-col items-center justify-center text-white text-2xl font-comic\\'><span class=\\'text-6xl mb-4\\'>ğŸ†</span><h1>í™”ì•½ì˜ ë¹„ë°€ê³¼<br>ìœ¨ì´ì˜ ëª¨í—˜</h1><p class=\\'text-sm mt-8 animate-pulse\\'>í™”ë©´ì„ í„°ì¹˜í•˜ì„¸ìš”</p></div>'">
                </div>
                <div class="absolute bottom-10 w-full text-center text-white font-comic animate-pulse text-xl drop-shadow-md">
                    í™”ë©´ì„ íƒ­í•˜ì—¬ ì‹œì‘í•˜ê¸°
                </div>
            `;
            app.appendChild(div);
        }

    function renderStoryPage(data, isQuizIntro) {
            const div = document.createElement('div');
            div.className = "w-full h-full flex flex-col bg-gray-100 fade-in";
            
            // ì´ë¯¸ì§€ ì˜ì—­ (flex-1ë¡œ ë‚¨ì€ ê³µê°„ ëª¨ë‘ ì°¨ì§€ -> ì•½ 65% ì˜ì—­)
            const imgHtml = `
                <div class="flex-1 img-container relative border-b-4 border-orange-400">
                    <img src="${data.image}" class="img-fit" alt="ì‚½í™”" onerror="this.parentElement.innerHTML='<div class=\\'w-full h-full bg-gray-800 flex items-center justify-center text-gray-500\\'>ì´ë¯¸ì§€ ë¡œë”© ì‹¤íŒ¨<br>${data.image}</div>'">
                </div>
            `;

            // í…ìŠ¤íŠ¸ ë° ì»¨íŠ¸ë¡¤ ì˜ì—­ (h-[35%] ë†’ì´ë¡œ ìˆ˜ì •)
            const textHtml = `
                <div class="h-[35%] flex flex-col relative">
                    <div class="flex-1 p-6 overflow-y-auto text-box -mt-6 z-10 text-lg leading-relaxed">
                        ${data.title ? `<h2 class="font-comic text-2xl text-orange-700 mb-1">${data.title}</h2>` : ''}
                        ${data.sub ? `<p class="text-sm text-gray-500 mb-4">${data.sub}</p>` : ''}
                        <div class="space-y-2">
                            ${data.content}
                        </div>
                    </div>
                    
                    <div class="h-20 bg-white flex justify-between items-center px-8 border-t border-gray-100 z-20">
                        <div onclick="prevPage()" class="flex flex-col items-center cursor-pointer text-gray-400 hover:text-gray-600 transition">
                            <span class="text-3xl filter grayscale opacity-50">ğŸ”¥</span>
                            <span class="text-xs font-bold mt-1">ì´ì „</span>
                        </div>
                        
                        ${isQuizIntro ? 
                            `<div onclick="startQuiz()" class="btn-quiz flex flex-col items-center cursor-pointer text-purple-600">
                                <div class="w-14 h-14 bg-purple-600 rounded-full flex items-center justify-center text-white text-3xl font-bold shadow-lg border-4 border-purple-300">?</div>
                                <span class="text-xs font-bold mt-1 text-purple-700">í€´ì¦ˆ ì‹œì‘!</span>
                            </div>` 
                            : 
                            `<div onclick="nextPage()" class="btn-fire flex flex-col items-center text-orange-500">
                                <span class="text-4xl filter drop-shadow-md">ğŸ”¥</span>
                                <span class="text-xs font-bold mt-1 text-red-600">ë‹¤ìŒ</span>
                            </div>`
                        }
                    </div>
                </div>
            `;
            
            div.innerHTML = imgHtml + textHtml;
            app.appendChild(div);
        }
        
        function renderQuiz() {
            // ëª¨ë“  í€´ì¦ˆê°€ ëë‚¬ìœ¼ë©´ ë‹¤ìŒ í˜ì´ì§€(ì—”ë”©)ë¡œ ì´ë™
            if (currentState.quizIndex >= quizData.length) {
                // ìˆ˜ì •: pageIndexë¥¼ storyDataì˜ ë§ˆì§€ë§‰ ì¸ë±ìŠ¤(ì—”ë”© í˜ì´ì§€)ë¡œ ì„¤ì •
                // storyData ë°°ì—´ì˜ ë§¨ ë§ˆì§€ë§‰ ìš”ì†Œê°€ 'ending' íƒ€ì…ì´ë¯€ë¡œ í•´ë‹¹ ì¸ë±ìŠ¤ë¡œ ì´ë™
                currentState.pageIndex = storyData.length - 1; 
                currentState.quizIndex = 0; // ì´ˆê¸°í™”
                render();
                return;
            }

            const currentQ = quizData[currentState.quizIndex];
            const div = document.createElement('div');
            div.className = "w-full h-full flex flex-col bg-purple-50 fade-in";

            let contentHtml = '';

            // ìƒíƒœ 1: ë¬¸ì œ í’€ê¸°
            if (currentState.quizStatus === 'question') {
                contentHtml = `
                    <div class="flex-1 flex flex-col items-center justify-center p-6 text-center">
                        <span class="text-purple-600 font-bold text-xl mb-4">ë¬¸ì œ ${currentState.quizIndex + 1} / 3</span>
                        <div class="bg-white p-8 rounded-2xl shadow-xl w-full mb-8 border-2 border-purple-200">
                            <p class="text-2xl font-bold leading-normal break-keep">${currentQ.question}</p>
                        </div>
                        <div class="flex gap-6 w-full justify-center">
                            <button onclick="checkAnswer(true)" class="w-24 h-24 bg-blue-500 rounded-full text-white text-5xl font-black shadow-lg hover:bg-blue-600 active:scale-95 transition">O</button>
                            <button onclick="checkAnswer(false)" class="w-24 h-24 bg-red-500 rounded-full text-white text-5xl font-black shadow-lg hover:bg-red-600 active:scale-95 transition">X</button>
                        </div>
                    </div>
                    <div class="h-20 bg-white border-t border-gray-200 flex items-center px-4">
                        <button onclick="exitQuiz()" class="text-gray-400 font-bold text-sm">â—€ ëŒì•„ê°€ê¸°</button>
                    </div>
                `;
            } 
            // ìƒíƒœ 2: ê²°ê³¼ (ì´ëª¨ì§€ í‘œì‹œ)
            else if (currentState.quizStatus === 'result') {
                const isCorrect = currentState.lastAnswer === currentQ.answer;
                const emoji = isCorrect ? 'ğŸ†' : 'ğŸ˜«'; // ğŸ† or ğŸ§Ÿ/ğŸ˜«
                const bgColor = isCorrect ? 'bg-blue-900' : 'bg-red-900';
                const message = isCorrect ? 'ì •ë‹µì…ë‹ˆë‹¤!' : 'í‹€ë ¸ì–´ìš”!';

                contentHtml = `
                    <div class="w-full h-full ${bgColor} flex flex-col items-center justify-center text-white cursor-pointer" onclick="showExplanation()">
                        <div class="text-9xl mb-6 animate-bounce">${emoji}</div>
                        <h2 class="text-4xl font-comic mb-4">${message}</h2>
                        <p class="animate-pulse text-lg opacity-80">í™”ë©´ì„ íƒ­í•˜ì—¬ í•´ì„¤ ë³´ê¸°</p>
                    </div>
                `;
            }
            // ìƒíƒœ 3: í•´ì„¤
            else if (currentState.quizStatus === 'explanation') {
                const isLastQuestion = currentState.quizIndex === quizData.length - 1;
                const nextButtonText = isLastQuestion ? "ëª¨í—˜ ë§ˆì¹˜ê¸°" : "ë‹¤ìŒ ë¬¸ì œë¡œ";

                contentHtml = `
                    <div class="flex-1 flex flex-col p-6 bg-white cursor-pointer" onclick="nextQuizStep()">
                        <div class="flex-1 flex flex-col justify-center items-center">
                            <h3 class="text-2xl font-comic text-purple-700 mb-6">ğŸ’¡ ìœ¨ì´ì˜ í•´ì„¤</h3>
                            <div class="bg-yellow-100 p-6 rounded-xl border-2 border-yellow-300 shadow-md w-full relative">
                                <div class="absolute -top-4 -left-2 text-4xl">ğŸ‘§ğŸ»</div>
                                <p class="text-xl font-medium text-gray-800 leading-relaxed mt-2 word-keep">
                                    "${currentQ.explanation}"
                                </p>
                            </div>
                        </div>
                        <div class="h-24 w-full flex items-center justify-center">
                            <div class="btn-fire flex flex-col items-center">
                                <span class="text-4xl">ğŸ”¥</span>
                                <span class="text-sm font-bold text-red-500 mt-1">${nextButtonText}</span>
                            </div>
                        </div>
                    </div>
                `;
            }

            div.innerHTML = contentHtml;
            app.appendChild(div);
        }

        function renderEnding(data) {
            const div = document.createElement('div');
            div.className = "w-full h-full relative cursor-pointer fade-in";
            div.onclick = restart;
            div.innerHTML = `
                <div class="img-container">
                    <img src="${data.image}" class="img-cover" alt="ë" onerror="this.parentElement.innerHTML='<div class=\\'w-full h-full bg-black flex flex-col items-center justify-center text-white\\'><span class=\\'text-6xl mb-4\\'>The End</span><p>ì´ë¯¸ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</p></div>'">
                </div>
                <div class="absolute bottom-10 w-full text-center text-white font-comic animate-pulse text-xl bg-black bg-opacity-30 py-2">
                    ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°
                </div>
            `;
            app.appendChild(div);
        }

        // --- ë¡œì§ í•¨ìˆ˜ë“¤ ---

        function nextPage() {
            if (currentState.pageIndex < storyData.length) {
                currentState.pageIndex++;
                render();
            }
        }

        function prevPage() {
            if (currentState.pageIndex > 0) {
                currentState.pageIndex--;
                render();
            }
        }

        function startQuiz() {
            // ìŠ¤í† ë¦¬ ë°°ì—´ì˜ ê¸¸ì´ì™€ ê°™ìœ¼ë©´ í€´ì¦ˆ ì„¹ì…˜ìœ¼ë¡œ ê°„ì£¼
            currentState.pageIndex = storyData.length; 
            currentState.quizIndex = 0;
            currentState.quizStatus = 'question';
            render();
        }

        function exitQuiz() {
            currentState.pageIndex--; // ë‹¤ì‹œ í€´ì¦ˆ ì¸íŠ¸ë¡œ í˜ì´ì§€ë¡œ
            render();
        }

        function checkAnswer(userAnswer) {
            currentState.lastAnswer = userAnswer;
            currentState.quizStatus = 'result';
            render();
        }

        function showExplanation() {
            currentState.quizStatus = 'explanation';
            render();
        }

        function nextQuizStep() {
            // ë‹¤ìŒ ë¬¸ì œ ì¤€ë¹„
            currentState.quizIndex++;
            currentState.quizStatus = 'question';
            render();
        }

        function restart() {
            currentState.pageIndex = 0;
            currentState.quizIndex = 0;
            render();
        }

        // ì´ˆê¸° ì‹¤í–‰
        render();

    </script>
</body>
</html>
